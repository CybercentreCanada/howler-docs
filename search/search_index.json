{"config":{"lang":["en","fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"developer/backend/","title":"Installation Procedure","text":"System dependencies <p>Before running these steps, ensure you have completed the installation steps here.</p> <p>Running the howler server, once dependencies are installed, is fairly simple. First, we start up the dependences. These include:</p> <ol> <li>Elasticsearch 8</li> <li>A redis instance</li> <li>A minio instance</li> </ol> <pre><code>cd ~/repos/howler-api\ncd dev &amp;&amp; docker compose up\n</code></pre> <p>Now we install the python packages Howler depends on:</p> <pre><code>cd ~/repos/howler-api\n\n# If you don't have python3.9 as the default, use python3.9 here instead\npython -m venv .venv\n\nsource .venv/bin/activate\n\npip install -r requirements.txt -r test/requirements.txt\n\npip install -e .\n</code></pre> <p>We need to setup a few folders on the system howler will use:</p> <pre><code>sudo mkdir -p /etc/howler/conf\nsudo mkdir -p /var/cache/howler\nsudo mkdir -p /var/lib/howler\nsudo mkdir -p /var/log/howler\n\nsudo chown -R $USER /etc/howler\nsudo chown $USER /var/cache/howler\nsudo chown $USER /var/lib/howler\nsudo chown $USER /var/log/howler\n</code></pre> <p>And then we initialize the configurations and add some users for testing:</p> <pre><code>./generate_howler_conf.sh\n\n# Create default users\npython howler/odm/random_data.py users\n</code></pre> <p>Finally, we can run howler!</p> <pre><code>python howler/app.py\n</code></pre>"},{"location":"developer/client/","title":"Client Development","text":"<p>Frontend stuff</p>"},{"location":"developer/frontend/","title":"Frontend Development","text":"System dependencies <p>Before running these steps, ensure you have completed the installation steps here.</p> <p>Running the howler UI for development is fairly straightforward:</p> <pre><code># Install dependencies\nyarn install\n\n# Run the development server\nyarn start\n</code></pre>"},{"location":"developer/frontend/#visual-studio-code","title":"Visual Studio Code","text":"<p>If developing in VS Code, it is recommended to install the recommended extensions, for built-in prettier and eslint support.</p>"},{"location":"developer/getting_started/","title":"System Dependencies","text":"<p>In order to contribute to Howler, you will first need to prepare your development environment.</p> Notes on Operating System <p>Please note that these commands were written for use in ubuntu, either on Windows through WSL or a standalone ubuntu OS. You will need to adapt the OS-specific instructions to your personal operating system.</p> <pre><code># While not strictly necessary, it is suggested to keep all howler repositories in a single folder.\n# Several scripts communicate across repositories, and are more efficient when sharing a parent folder.\nmkdir ~/repos &amp;&amp; cd ~/repos\n\n# Clone the howler repositories\ngit clone git@github.com:CybercentreCanada/howler-ui.git\ngit clone git@github.com:CybercentreCanada/howler-api.git\ngit clone git@github.com:CybercentreCanada/howler-client.git\n</code></pre>"},{"location":"developer/getting_started/#frontend-dependencies","title":"Frontend dependencies","text":""},{"location":"developer/getting_started/#node","title":"Node","text":"<p>Howler's UI is developed using vite, which requires node v20 or higher. We'll use Node Version Manager to download and install node v20.</p> Installing without NVM <p>NVM isn't required - if you'd rather install node yourself, you can do so - just make sure the version you install is compatible with vite.</p> <pre><code># Install nvm\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n\n# You can skip these commands if you restart your shell\nexport NVM_DIR=\"$HOME/.nvm\"\n[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\"                   # This loads nvm\n[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion\n\n# Install and use node version 20\nnvm install v20\nnvm use v20\n\n# Optional if you have other projects depending on other versions of node\nnvm alias default v20\n</code></pre>"},{"location":"developer/getting_started/#yarn","title":"Yarn","text":"<p>Howler's UI uses Yarn for package management.</p> <pre><code>npm install -g yarn\n</code></pre>"},{"location":"developer/getting_started/#backend-dependencies","title":"Backend Dependencies","text":"<p>Howler's backend depends on a number of docker containers in order to properly run. To this end, you must have docker and docker-compose installed. To that end, follow the installation steps outlined here, copied below for convenience:</p> Alternative Installation Methods <p>Docker has a number of options for installation. This is the tested method, but other approaches should work without issue.</p> <pre><code># Add Docker's official GPG key:\nsudo apt-get update\nsudo apt-get install ca-certificates curl gnupg\nsudo install -m 0755 -d /etc/apt/keyrings\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg\nsudo chmod a+r /etc/apt/keyrings/docker.gpg\n\n# Add the repository to Apt sources:\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release &amp;&amp; echo \"$VERSION_CODENAME\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null\nsudo apt-get update\n\n# Install the latest version\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\n# Verify it's working\nsudo docker run hello-world\n</code></pre> <p>If you'd rather not run <code>sudo</code> for every docker command:</p> <pre><code># Add the docker group. If it fails, no problem\nsudo groupadd docker\n\n# Add the current user to the docker group\nsudo usermod -aG docker $USER\n</code></pre> <p>Next up, Python. Howler runs on Python 3.9, so we'll install that:</p> <pre><code>sudo apt install software-properties-common\nsudo add-apt-repository ppa:deadsnakes/ppa\nsudo apt update\nsudo apt install python3.9 python3.9-distutils python3.9-venv\n\npython3.9 --version\n\n# If you want to run python3.9 as default\nsudo update-alternatives --install /usr/bin/python python /usr/bin/python3.9 1\n\npython --version\n\n# Install pip\npython -m ensurepip\n\n# If you want to run pip3.9 as default\nsudo update-alternatives --install $HOME/.local/bin/pip python $HOME/.local/bin/pip3.9 1\n\npip --version\n</code></pre>"},{"location":"developer/random_data/","title":"Generating Random Data","text":"<p>To get an idea of what Howler looks like with data, and to test your code, you can use the helper file <code>howler/odm/random_data.py</code>. It contains methods for generating test data for all models used in howler:</p> <pre><code>cd ~/repos/howler-api\n\n# Run without arguments, all models are wiped and populated with test data\npython howler/odm/random_data.py\n\n# You can also choose specific indexes to populate\npython howler/odm/random_data.py users hits analytics\n</code></pre>"},{"location":"ingestion/authentication/","title":"Authentication","text":""},{"location":"ingestion/authentication/#howler-authentication","title":"Howler Authentication","text":"<p>Howler's API supports a number of authentication approaches when accessing the API. This document will outline the different approaches, and explain how to use each of them.</p>"},{"location":"ingestion/authentication/#types-of-authentication","title":"Types of Authentication","text":"<p>There are four methods of authentication one can use to connect to the howler API:</p> <ol> <li>Username and Password</li> <li>Username and API Key</li> <li>Username and app token (after login)</li> <li>OAuth Access Token</li> </ol> <p>We will outline the use case for each authentication type next.</p>"},{"location":"ingestion/authentication/#usernamepassword-authentication","title":"Username/Password Authentication","text":"<p>Username and password authentication is the simplest and least secure method of authentication. Unlikely to be enabled in a production environment, it allows users to easily connect to the Howler API and make changes as the given user, without having to worry about creating API keys or using an OAuth provider like Keycloak or Azure. Users can connect using username and password authentication in one of two ways:</p>"},{"location":"ingestion/authentication/#direct-call-to-the-requisite-endpoint-password","title":"Direct Call to the Requisite Endpoint (Password)","text":"<p>This is far and away the simplest method. Simply add a basic Authorization header to the HTTP request you want to make, and everything is taken care of:</p> <pre><code># Note that this format is &lt;username&gt;:&lt;password&gt;\necho -n \"user:user\" | base64 -w0\n# -&gt; dXNlcjp1c2Vy\n</code></pre> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic dXNlcjp1c2Vy\n</code></pre>"},{"location":"ingestion/authentication/#exchanging-for-an-app-token-password","title":"Exchanging for an App Token (Password)","text":"<p>This is a slightly more complex approach, but carries the benefit of not exposing the username and password on every request. You can leverage the <code>v1/auth/login</code> endpoint to exchange your username and password for an app token. The token works similarly to an OAuth access token - you provide it with each subsequent request, and it authenticates you until the token expires.</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"user\": \"user\",\n  \"password\": \"user\"\n}\n</code></pre> <p>Will return something like:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"app_token\": \"user:5791a142067745c3af51d6596da7da8f86357a9fa92ad78d1ce118ea7d89d34e\",\n    \"provider\": null,\n    \"refresh_token\": null\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Using this token in another API call:</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer user:5791a142067745c3af51d6596da7da8f86357a9fa92ad78d1ce118ea7d89d34e\n</code></pre>"},{"location":"ingestion/authentication/#usernameapi-key-authentication","title":"Username/API Key Authentication","text":"<p>The username and API Key authentication works largely the same as username/password from the perspective of the client. On the server side, however, API keys have several key advantages. Firstly, they can easily be revoked by the user. Secondly, their privileges can be limited, allowing only a subset of permissions.</p> <p>There are two methods of authentication, mirroring the username and password:</p>"},{"location":"ingestion/authentication/#direct-call-to-the-requisite-endpoint-api-key","title":"Direct Call to the Requisite Endpoint (API Key)","text":"<p>Simply add a basic Authorization header containing the username and API key to the HTTP request you want to make, and everything is taken care of:</p> <pre><code># note the format is &lt;username&gt;:&lt;apikeyname&gt;:&lt;secret&gt;\necho -n \"user:devkey:user\" | base64 -w0\n# -&gt; dXNlcjpkZXZrZXk6dXNlcg==\n</code></pre> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic dXNlcjpkZXZrZXk6dXNlcg==\n</code></pre>"},{"location":"ingestion/authentication/#exchanging-for-an-app-token-api-key","title":"Exchanging for an App Token (API Key)","text":"<p>You can also leverage the <code>v1/auth/login</code> endpoint to exchange your username and API key for an app token. The token works similarly to an OAuth access token - you provide it with each subsequent request, and it authenticates you until the token expires.</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"user\": \"user\",\n  \"apikey\": \"devkey:user\"\n}\n</code></pre> <p>Will return something like:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"app_token\": \"user:f220eb76ff8404abfece8c0c2f3368c7d89618c776bedcd3a506843dc4a952e4\",\n    \"provider\": null,\n    \"refresh_token\": null\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Using this token in another API call:</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer user:f220eb76ff8404abfece8c0c2f3368c7d89618c776bedcd3a506843dc4a952e4\n</code></pre> <p>Note that when logging in using an api key, the permissions of the api key continue to apply. So if you try and access an endpoint that requires the \"write\" permission with an API key that only has read permission, this will cause a 403 Forbidden error.</p>"},{"location":"ingestion/authentication/#access-token-authentication","title":"Access Token Authentication","text":"<p>In addition to the authentication methods provided internally by Howler, you can also authenticate with an external OAuth provider like Azure or Keycloak. To do this, you must obtain an access token from one of these providers. In order to get an access token, there are generally two flows - On-Behalf-Of, or the user login flow (see here for a rundown of that). In the case of Howler, the <code>v1/auth/login</code> endpoint is used for step D &amp; E in the linked user login flow, and it returns the following:</p> <pre><code>{\n    \"api_response\": {\n        \"app_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyIn0\",\n        \"provider\": \"keycloak\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNoIn0\"\n    }\n}\n</code></pre> <p>In this case, the <code>app_token</code> is the JSON Web Token the application uses as an access token. Similarly, the <code>refresh_token</code> is another JWT that is used to refresh the access token if needed. Finally, the <code>provider</code> field outlines which provider this access token corresponds to.</p> <p>Once you have that access token, you can simply pass it along in the Authorization header:</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyIn0\n</code></pre> <p>Howler will automatically detect this is a JWT, and treat it as such. If the token is valid, the user will be authenticated.</p> <p>In order to refresh an expired access token, you can use the following API call:</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"oauth_provider\": \"keycloak\",\n  \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNoIn0\"\n}\n</code></pre> <p>And you'll get something like this back:</p> <pre><code>{\n    \"api_response\": {\n        \"app_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMiJ9\",\n        \"provider\": \"keycloak\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNodG9rZW4yIn0\"\n    }\n}\n</code></pre>"},{"location":"ingestion/authentication/#impersonation","title":"Impersonation","text":"<p>The final important bit of the authentication flow is the impersonation functionality. In order for a service account or other user to impersonate you (i.e. to create alerts on your behalf), Howler allows users to provide a second API key in order to authenticate as another user.</p> <p>Before you use another user's API key to authenticate as them, it's important that the API key you're using has been marked as valid for impersonation - check with the user that provided it. If it has, you can use it by, formating your request as follows:</p> <pre><code># Your credentials\necho -n \"admin:devkey:admin\" | base64 -w0\n# -&gt; YWRtaW46ZGV2a2V5OmFkbWlu\n\n# Their credentials\necho -n \"user:impersonate_admin:user\" | base64 -w0\n# -&gt; dXNlcjppbXBlcnNvbmF0ZV9hZG1pbjp1c2Vy\n</code></pre> Note <p>Any form of authentication can be used by the impersonator, but validated API keys are the only permitted authentication method for the person you're impersonating.</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic YWRtaW46ZGV2a2V5OmFkbWlu\nX-Impersonating: Basic dXNlcjppbXBlcnNvbmF0ZV9hZG1pbjp1c2Vy\n</code></pre> <p>If set up correctly, the result will look like:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"avatar\": null,\n    \"classification\": \"TLP:W\",\n    \"email\": \"user@howler.example.com\",\n    \"groups\": [\n      \"USERS\"\n    ],\n    \"is_active\": true,\n    \"is_admin\": false,\n    \"name\": \"User\",\n    \"roles\": [\n      \"user\"\n    ],\n    \"username\": \"user\"\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Note that the server returned this as if you were <code>user</code>, NOT <code>admin</code>. It is clearly marked in the logs, however, that you are making the request:</p> <pre><code>22/12/05 14:15:02 INFO howler.api.security | Authenticating user for path /api/v1/user/whoami/\n22/12/05 14:15:03 WARNING howler.api.security | admin is impersonating user\n22/12/05 14:15:03 INFO howler.api.security | Logged in as user from 127.0.0.1\n22/12/05 14:15:03 INFO howler.api | GET /api/v1/user/whoami/ - 200\n</code></pre>"},{"location":"ingestion/bundles/","title":"Bundles","text":""},{"location":"ingestion/bundles/#howler-hit-bundles","title":"Howler Hit Bundles","text":"<p>Hit bundles can be used to easily package together a large number of similar alerts, allowing analysts to easily triage them as a single incident. For example, consider a single computer that repeatedly makes a network call to <code>baddomain.ru</code> - while an alert may be generated for every instance of this computer hitting that domain, it makes sense for analysts to treat all these alerts as a single case.</p>"},{"location":"ingestion/bundles/#creating-bundles-through-the-howler-client","title":"Creating bundles through the Howler Client","text":"<p>There are a couple of ways to create a bundle through the howler client:</p> <pre><code>from howler_client import get_client\n\nhowler = get_client(\"https://howler.example.com\")\n\n\"\"\"Creating a howler bundle and the hits at the same time\"\"\"\nhowler.bundle.create(\n    # First argument is the bundle hit\n    {\n        \"howler.analytic\": \"example-test\",\n        \"howler.score\": 0\n    },\n    # Second argument is a hit or list of hits to include in the bundle\n    [\n        {\n            \"howler.analytic\": \"example-test\",\n            \"howler.score\": 0\n        },\n        {\n            \"howler.analytic\": \"example-test\",\n            \"howler.score\": 0\n        }\n    ]\n)\n\n\"\"\"Creating a howler bundle from existing hits\"\"\"\nhowler.bundle.create(\n    {\n        \"howler.analytic\": \"example-test\",\n        \"howler.score\": 0,\n        \"howler.hits\": [\"YcUsL8QsjmwwIdstieROk\", \"6s7MztwuSvz6tM0PgGJhvz\"]\n    },\n    # Note: In future releases, you won't need to include this argument\n    []\n)\n\n\n\"\"\"Creating from a map\"\"\"\nbundle_hit = {\n    \"score\": 0,\n    \"bundle\": True\n}\n\nmap = {\n    \"score\": [\"howler.score\"],\n    \"bundle\": [\"howler.is_bundle\"]\n}\n\nhowler.bundle.create_from_map(\"example-test\", bundle_hit, map, [{\"score\": 0}])\n</code></pre>"},{"location":"ingestion/bundles/#viewing-bundles-on-the-howler-ui","title":"Viewing bundles on the Howler UI","text":"<p>In order to view created bundles on the Howler UI, you can use the query <code>howler.is_bundle:true</code>. This will provide a list of created bundles you can look through.</p> <p>Clicking on a bundle will open up a slightly different search UI to normal. In this case, we automatically filter the search results to include only hits that are included in the bundle. To make this obvious, the header representing the bundle will appear above the search bar.</p> <p>You can continue to filter through hits using the same queries as usual, and view them as usual. When triaging a bundle, assessing it will apply this assessment to all hits in the bundle, except those that have already been triaged. That is, if the bundle is open, all open hits will be assessed when you assess it.</p> <p>Bundles also have a Summary tab not available for regular hits. This summary tab will aid you in aggregating data about all the hits in the bundle. Simply open the tab and click \"Create Summary\". Note that this may take some time, as a large number of queries are being run to aggregate the data.</p>"},{"location":"ingestion/client/","title":"Client","text":""},{"location":"ingestion/client/#howler-client-documentation","title":"Howler Client Documentation","text":"<p>This documentation will outline how to interact with the howler API using the howler client in Python development environments. We will outline the basic process of creating a new hit in each environment as well as searching howler for hits matching your query.</p>"},{"location":"ingestion/client/#getting-started","title":"Getting started","text":""},{"location":"ingestion/client/#installation","title":"Installation","text":"<p>In order to use the howler client, you need to list it as a dependency in your project.</p>"},{"location":"ingestion/client/#python","title":"Python","text":"<p>Simply install through pip:</p> <pre><code>pip install howler_client\n</code></pre> <p>You can also add it to your requirements.txt, or whatever dependency management system you use. Once this is complete, you should be able to start using the howler client!</p>"},{"location":"ingestion/client/#authentication","title":"Authentication","text":"<p>As outlined in the Authentication Documentation, there's a number of ways users can choose to authenticate. In order to interface with the howler client, however, the suggested flow is to use an API key. This API Key will be supplied to your code later on.</p>"},{"location":"ingestion/client/#python-client","title":"Python Client","text":"<p>In order to connect with howler using the python client, we can create our API Key object and provide it, along with the howler api url, to the Howler client to establish a connection:</p> <pre><code>from howler_client import get_client\n\nUSERNAME = 'user' # Obtain this from the user settings page of the Howler UI\nAPIKEY = 'apikey_name:apikey_data'\n\napikey = (USERNAME, APIKEY)\n\nhowler = get_client(\"howler.example.com\", apikey=apikey)\n</code></pre> <p>That's it! You can now use the <code>howler</code> object to interact with the server. So what does that actually look like?</p>"},{"location":"ingestion/client/#creating-hits-in-python","title":"Creating hits in Python","text":"<p>For the python client, you can create hits using the <code>howler.hit.create_from_map</code> function. This function takes in three arguments:</p> <ul> <li><code>tool_name</code>: The name of the analytic creating the hit</li> <li><code>map</code>: A mapping between the raw data you have and the howler schema</li> <li>The format is a dictionary where the keys are the flattened path of the raw data, and the values are a list of flattened paths for Howler's fields where the data will be copied into.</li> <li><code>documents</code>: The raw data you want to add to howler</li> </ul> <p>Here is a simple example:</p> <pre><code># The mapping from our data to howler's schema\nhwl_map = {\n  \"file.sha256\": [\"file.hash.sha256\", \"howler.hash\"],\n  \"file.name\": [\"file.name\"],\n  \"src_ip\": [\"source.ip\", \"related.ip\"],\n  \"dest_ip\": [\"destination.ip\", \"related.ip\"],\n  \"time.created\": [\"event.start\"],\n}\n\n# Some bogus data in a custom format we want to add to howler\nexample_hit = {\n  \"src_ip\": \"0.0.0.0\",\n  \"dest_ip\": \"8.8.8.8\",\n  \"file\": {\n    \"name\": \"hello.exe\",\n    \"sha256\": sha256(str(\"hello.exe\").encode()).hexdigest()\n  },\n  \"time\": {\n    \"created\": datetime.now().isoformat()\n  },\n}\n\n# Note that the third argument is of type list!\nhowler.hit.create_from_map(\"example_ingestor\", hwl_map, [example_hit])\n</code></pre>"},{"location":"ingestion/client/#querying-hits-in-python","title":"Querying hits in Python","text":"<p>Querying hits using the howler python client is done using the <code>howler.search.hit</code> function. It has a number of required and optional arguments:</p> <ul> <li>Required:</li> <li><code>query</code>: lucene query (string)</li> <li>Optional:</li> <li><code>filters</code>: Additional lucene queries used to filter the data (list of strings)</li> <li><code>fl</code>: List of fields to return (comma separated string of fields)</li> <li><code>offset</code>: Offset at which the query items should start (integer)</li> <li><code>rows</code>: Number of records to return (integer)</li> <li><code>sort</code>: Field used for sorting with direction (string: ex. 'id desc')</li> <li><code>timeout</code>: Max amount of milliseconds the query will run (integer)</li> <li><code>use_archive</code>: Also query the archive</li> <li><code>track_total_hits</code>: Number of hits to track (default: 10k)</li> </ul> <p>Here are some example queries:</p> <pre><code># Search for all hits created by assemblyline, show the first 50, and return only their ids\nhowler.search.hit(\"howler.analytic:assemblyline\", fl=\"howler.id\", rows=50)\n\n# Search for all resolved hits created in the last five days, returning their id and the analytic that created them. Show only ten, offset by 40\nhowler.search.hit(\"howler.status:resolved\", filters=['event.created:[now-5d TO now]'] fl=\"howler.id,howler.analytic\", rows=10, offset=40)\n\n# Search for all hits, timeout if the query takes more than 100ms\nhowler.search.hit(\"howler.id:*\", track_total_hits=100000000, timeout=100, use_archive=True)\n</code></pre>"},{"location":"ingestion/example/","title":"Example Ingestion Using Atomic Red Team","text":"<p>This article will outline a very basic example of how to ingest hits into Howler, using Atomic Red Team to simulate Binary padding of a malicious file (T1027.001).</p>"},{"location":"ingestion/example/#preparing-a-docker-container","title":"Preparing a Docker Container","text":"<p>In order to run Atomic Red Team and detect the resulting files, we'll need to slightly modify the docker file, to install python 3.9. First, create a new folder to include the Dockerfile and dependent files in:</p> <pre><code>mkdir -p ~/atomic-red-team-custom\n\n# This is the test file we'll use to run the detection\necho \"Hello, world\\!\" &gt; test.txt\n\ntouch Dockerfile\ntouch detection.py\n</code></pre> <p>Put the following into the Dockerfile:</p> <pre><code>FROM redcanary/invoke-atomicredteam:latest\n\nRUN add-apt-repository ppa:deadsnakes/ppa &amp;&amp; \\\n    apt-get update\n\nRUN bash -c \"DEBIAN_FRONTEND=noninteractive TZ=Etc/UTC apt-get -y install tzdata\" &amp;&amp; \\\n    apt-get install -y python3.9 python3.9-distutils python3.9-venv\n\n\nRUN python3.9 -m ensurepip\n\nRUN python3.9 -m pip install howler-client==1.6.0.dev16137\n\nCOPY detection.py /root/detection.py\nCOPY test.txt /root/test.txt\nCOPY test.txt /root/test_control.txt\n\nWORKDIR /root\n</code></pre> <p>And this script into <code>detection.py</code>:</p> <pre><code>import sys\nimport hashlib\n\nfrom howler_client import get_client\n\nUSERPASS = ('&lt;USERNAME_HERE&gt;', '&lt;PASSWORD&gt;')\n\nhowler = get_client(\"&lt;HOWLER_URL_HERE&gt;\", auth=APIKEY)\nsha256 = hashlib.sha256()\n\nwith open(\"test_control.txt\", \"rb\") as f:\n    while True:\n        data = f.read(65536)\n        if not data:\n            break\n\n        sha256.update(data)\n\ncontrol_hash = sha256.hexdigest()\nprint(f\"Control hash value: {control_hash}\")\n\nsha256 = hashlib.sha256()\nwith open(\"test.txt\", \"rb\") as f:\n    while True:\n        data = f.read(65536)\n        if not data:\n            break\n\n        sha256.update(data)\n\npadded_hash = sha256.hexdigest()\nprint(f\"Padded hash value: {padded_hash}\")\n\nif padded_hash != control_hash:\n    print(\"Binary padding detected! Creating alert\")\n\n    howler.hit.create(\n        {\n            \"howler.analytic\": \"ATR Ingestion Example\",\n            \"howler.detection\": \"Binary Padding\",\n            \"howler.score\": 0,\n            \"threat.technique.id\": \"T1027.001\",\n            \"threat.technique.name\": \"Obfuscated Files or Information: Binary Padding\",\n            \"threat.technique.reference\": \"https://attack.mitre.org/techniques/T1027/001/\",\n            \"related.hash\": [control_hash, padded_hash],\n        }\n    )\nelse:\n    print(\"Binary padding not detected\")\n</code></pre> <p>For information on creating an API Key, see Generating an API Key. The API key should have Read and Write permissions.</p>"},{"location":"ingestion/example/#building-and-running-the-docker-container","title":"Building and Running the Docker Container","text":"<p>Now, you can run <code>docker build</code>:</p> <pre><code>docker build -t invoke-atomicredteam-custom:latest .\ndocker run --name test-howler-ingestion -it invoke-atomicredteam-custom:latest\n</code></pre> <p>After running this, you should see:</p> <pre><code>PowerShell 7.4.0\nLoading personal and system profiles took 700ms.\nPS /&gt;\n</code></pre>"},{"location":"ingestion/example/#executing-the-detection","title":"Executing the Detection","text":"<p>If you run the detection file:</p> <pre><code>PS /root&gt; python3.9 ./detection.py\nControl hash value: d9014c4624844aa5bac314773d6b689ad467fa4e1d1a50a1b8a99d5a95f72ff5\nPadded hash value: d9014c4624844aa5bac314773d6b689ad467fa4e1d1a50a1b8a99d5a95f72ff5\nBinary padding not detected\n</code></pre> <p>Now, we can run the atomic test:</p> <pre><code>Invoke-AtomicTest T1027.001-1 -PromptForInputArgs\n</code></pre> <p>You should be prompted like so:</p> <pre><code>Enter a value for file_to_pad, or press enter to accept the default.\nPath of binary to be padded [/tmp/evil-binary]:\n</code></pre> <p>Enter the path to the test file, and run. Now, rerunning the detection:</p> <pre><code>Control hash value: d9014c4624844aa5bac314773d6b689ad467fa4e1d1a50a1b8a99d5a95f72ff5\nPadded hash value: ea0283ed5c7d578fe229ca383def3d08c8d2bebb164671371ecb35279993be5e\nBinary padding detected! Creating alert\n</code></pre> <p>If you check your howler instance, you should now see a new alert!</p> Note on Reused Alerts <p>One caveat is that, if a hit is identical each time (like the above alert), the howler client will automatically reuse that alert. To circumvent this, simply add a random/custom <code>howler.hash</code> field.</p>"},{"location":"ingestion/example/#conclusion","title":"Conclusion","text":"<p>You've now created an extremely basic script that checks two files for mismatching hashes. In reality, you'd want to run heuristics to see if these files are similar and THEN alert, but this is more to illustrate a use case of Howler, and the basic process of ingestion.</p>"},{"location":"ingestion/key_generation/","title":"Generating an API key","text":"<p>While integrating Howler into another system, you should not save your username and password into another app. Instead, you should create an API Key with only the appropriate requirements for that specific integration.</p>"},{"location":"ingestion/key_generation/#creating-an-api-key","title":"Creating an API key","text":"<ol> <li>Login to Howler's user interface with the user that will perform API requests</li> <li>Click on your avatar in the top-right corner of the Howler UI and select \"Settings\"</li> <li>Scroll down to the bottom to the \"User Security\" section and press the plus button.</li> <li>Add the API Key name, select access privileges and expiry dates then click the \"Create\" button.</li> <li>The API Key will only be displayed once and can't be recovered. Copy it somewhere safe so that you can use it later.</li> <li>Close the Drawer.</li> </ol>"},{"location":"ingestion/links/","title":"Links","text":""},{"location":"ingestion/links/#hit-links","title":"Hit Links","text":"<p>In order to facilitate the addition of additional tools one can use to triage a hit, Howler allows users to specify a set of links, along with a title and icon to show. This documentation will walk you through how to use these links.</p>"},{"location":"ingestion/links/#specification","title":"Specification","text":"<p>In order to add links, you can use the <code>howler.links</code> field. This field takes in a list of objects with three keys:</p> <pre><code>hit = {\n  \"howler.links\": [\n    {\n      \"title\": \"Link Title with Internal Image\",\n      \"href\": \"https://example.com\",\n      # Note that this specifies another application, not an image link\n      \"icon\": \"superset\",\n    },\n    {\n      \"title\": \"Link Title with External Image\",\n      \"href\": \"https://www.britannica.com/animal/goose-bird\",\n      # Note that this specifies an image link. We don't provide hosting, so you'll need to host it somewhere else!\n      \"icon\": \"https://cdn.britannica.com/76/76076-050-39DDCBA1/goose-Canada-North-America.jpg\",\n    },\n  ]\n}\n</code></pre>"},{"location":"ingestion/user/","title":"Creating Users in Howler","text":"<p>Howler does not currently have a graphical interface for creating users. The generally suggested manner of creating users is by connecting Howler to an OAuth 2.0 provider (azure, google, etc.) and creating a user based on the returned JWT authentication token. This is already handled in howler, and just requires setting up an external OAuth provider (see here for configuration information).</p> <p>If you'd like to create a user directly, without the use of OAuth creation, you can currently use the following script, on the same machine Howler is hosted on:</p> <pre><code>from howler.common.logging import get_logger\nfrom howler.odm.models.user import User\nfrom howler.security.utils import get_password_hash\nfrom howler.common.loader import datastore\n\nlogger = get_logger(__file__)\n\n\ndef create_user(name: str, email: str, username: str):\n    \"\"\"Create a basic user with username, email and password\"\"\"\n\n    ds = datastore()\n\n    user_data = User(\n        {\n            \"name\": name,\n            \"email\": email,\n            \"password\": get_password_hash(username),\n            \"uname\": f\"{username}\",\n        }\n    )\n    ds.user.save(username, user_data)\n    logger.info(f\"{username}:{username}\")\n\n    ds.user.commit()\n\n\nif __name__ == \"__main__\":\n    name = input(\"Enter Name:\\n&gt; \")\n    username = input(\"\\nEnter Username:\\n&gt; \")\n    email = input(\"\\nEnter Email:\\n&gt; \")\n\n    print(\n        f\"New user will be created.\\n\\tName: {name}\\n\\tUsername: {username}\\n\\tEmail: {email}\"\n    )\n\n    create_user(name, email, username)\n</code></pre> <p>A ticket for graphical user creation has been created.</p>"},{"location":"installation/configuration/","title":"Configuration","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"installation/configuration/#config","title":"Config","text":"<p>Howler Deployment Configuration</p> Field Type Description Required Default auth Auth Authentication module configuration  Yes See Auth for more details. core Core Core component configuration  Yes See Core for more details. datastore Datastore Datastore configuration  Yes See Datastore for more details. filestore Filestore Filestore configuration  Yes See Filestore for more details. logging Logging Logging configuration  Yes See Logging for more details. system System System configuration  Yes See System for more details. ui UI UI configuration parameters  Yes See UI for more details."},{"location":"installation/configuration/#apmserver","title":"APMServer","text":"<p>None</p> Field Type Description Required Default server_url Keyword URL to API server  Optional <code>None</code> token Keyword Authentication token for server  Optional <code>None</code>"},{"location":"installation/configuration/#auth","title":"Auth","text":"<p>Authentication Methods</p> Field Type Description Required Default allow_apikeys Boolean Allow API keys?  Yes <code>None</code> allow_extended_apikeys Boolean Allow extended API keys?  Yes <code>None</code> max_apikey_duration_amount Integer Amount of unit of maximum duration for API keys  Optional <code>None</code> max_apikey_duration_unit Enum Unit of maximum duration for API keysValues:<code>\"days\", \"hours\", \"minutes\", \"seconds\", \"weeks\"</code>  Optional <code>None</code> internal Internal Internal authentication settings  Yes See Internal for more details. oauth OAuth OAuth settings  Yes See OAuth for more details."},{"location":"installation/configuration/#core","title":"Core","text":"<p>Howler Core Component Configuration</p> Field Type Description Required Default metrics Metrics Configuration for Metrics Collection  Yes See Metrics for more details. redis Redis Configuration for Redis instances  Yes See Redis for more details."},{"location":"installation/configuration/#datastore","title":"Datastore","text":"<p>Datastore Configuration</p> Field Type Description Required Default hosts List [Host] List of hosts used for the datastore  Yes <code>None</code> ilm ILM Index Lifecycle Management Policy  Yes See ILM for more details. type Enum Type of application used for the datastoreValues:<code>\"elasticsearch\"</code>  Yes <code>None</code>"},{"location":"installation/configuration/#filestore","title":"Filestore","text":"<p>Filestore Configuration</p> Field Type Description Required Default storage List [Host] List of filestores used for storage  Yes <code>None</code>"},{"location":"installation/configuration/#host","title":"Host","text":"<p>Host Entries</p> Field Type Description Required Default name Keyword Name of the host  Yes <code>None</code> username Keyword Username to login with  Optional <code>None</code> password Keyword Password to login with  Optional <code>None</code> apikey_id Keyword ID of the API Key to use when connecting  Optional <code>None</code> apikey_secret Keyword Secret data of the API Key to use when connecting  Optional <code>None</code> scheme Keyword Scheme to use when connecting  Optional <code>http</code> host Keyword URL to connect to  Yes <code>None</code>"},{"location":"installation/configuration/#ilm","title":"ILM","text":"<p>Index Lifecycle Management</p> Field Type Description Required Default enabled Boolean Are we enabling ILM across indices?  Yes <code>None</code> days_until_archive Integer Days until documents get archived  Yes <code>None</code> indexes Mapping [ILMParams] Index-specific ILM policies  Yes See ILMParams for more details. update_archive Boolean Do we want to update documents in the archive?  Yes <code>None</code>"},{"location":"installation/configuration/#ilmparams","title":"ILMParams","text":"<p>Parameters associated to ILM Policies</p> Field Type Description Required Default warm Integer How long, per unit of time, should a document remain in the 'warm' tier?  Yes <code>None</code> cold Integer How long, per unit of time, should a document remain in the 'cold' tier?  Yes <code>None</code> delete Integer How long, per unit of time, should a document remain before being deleted?  Yes <code>None</code> unit Enum Unit of time used by <code>warm</code>, <code>cold</code>, <code>delete</code> phasesValues:<code>\"d\", \"h\", \"m\"</code>  Yes <code>None</code>"},{"location":"installation/configuration/#internal","title":"Internal","text":"<p>Internal Authentication Configuration</p> Field Type Description Required Default enabled Boolean Internal authentication allowed?  Yes <code>None</code> failure_ttl Integer How long to wait after <code>max_failures</code> before re-attempting login?  Yes <code>None</code> max_failures Integer Maximum number of fails allowed before timeout  Yes <code>None</code> password_requirements PasswordRequirement Password requirements  Yes See PasswordRequirement for more details."},{"location":"installation/configuration/#logging","title":"Logging","text":"<p>Model Definition for the Logging Configuration</p> Field Type Description Required Default log_level Enum What level of logging should we have?Values:<code>\"CRITICAL\", \"DEBUG\", \"DISABLED\", \"ERROR\", \"INFO\", \"WARNING\"</code>  Yes <code>None</code> log_to_console Boolean Should we log to console?  Yes <code>None</code> log_to_file Boolean Should we log to files on the server?  Yes <code>None</code> log_directory Keyword If <code>log_to_file: true</code>, what is the directory to store logs?  Yes <code>None</code> log_to_syslog Boolean Should logs be sent to a syslog server?  Yes <code>None</code> syslog_host Keyword If <code>log_to_syslog: true</code>, provide hostname/IP of the syslog server?  Yes <code>None</code> syslog_port Integer If <code>log_to_syslog: true</code>, provide port of the syslog server?  Yes <code>None</code> export_interval Integer How often, in seconds, should counters log their values?  Yes <code>None</code> log_as_json Boolean Log in JSON format?  Yes <code>None</code>"},{"location":"installation/configuration/#metrics","title":"Metrics","text":"<p>Metrics Configuration</p> Field Type Description Required Default apm_server APMServer APM server configuration  Yes See APMServer for more details."},{"location":"installation/configuration/#oauth","title":"OAuth","text":"<p>OAuth Configuration</p> Field Type Description Required Default enabled Boolean Enable use of OAuth?  Yes <code>None</code> gravatar_enabled Boolean Enable gravatar?  Yes <code>None</code> providers Mapping [OAuthProvider] OAuth provider configuration  Yes See OAuthProvider for more details. strict_apikeys Boolean Only allow apikeys that last as long as the access token used to log in  Yes <code>False</code>"},{"location":"installation/configuration/#oauthautoproperty","title":"OAuthAutoProperty","text":"<p>None</p> Field Type Description Required Default field Keyword Field to apply <code>pattern</code> to  Yes <code>None</code> pattern Keyword Regex pattern for auto-prop assignment  Yes <code>None</code> type Enum Type of property assignment on pattern matchValues:<code>\"access\", \"classification\", \"role\"</code>  Yes <code>None</code> value Keyword Assigned property value  Yes <code>None</code>"},{"location":"installation/configuration/#oauthprovider","title":"OAuthProvider","text":"<p>OAuth Provider Configuration</p> Field Type Description Required Default auto_create Boolean Auto-create users if they are missing  Yes <code>True</code> auto_sync Boolean Should we automatically sync with OAuth provider?  Yes <code>False</code> auto_properties List [OAuthAutoProperty] Automatic role and classification assignments  Yes <code>[]</code> uid_randomize Boolean Should we generate a random username for the authenticated user?  Yes <code>False</code> uid_randomize_digits Integer How many digits should we add at the end of the username?  Yes <code>0</code> uid_randomize_delimiter Keyword What is the delimiter used by the random name generator?  Yes <code>-</code> uid_regex Keyword Regex used to parse an email address and capture parts to create a user ID out of it  Optional <code>None</code> uid_format Keyword Format of the user ID based on the captured parts from the regex  Optional <code>None</code> client_id Keyword ID of your application to authenticate to the OAuth provider  Optional <code>None</code> client_secret Keyword Password to your application to authenticate to the OAuth provider  Optional <code>None</code> request_token_url Keyword URL to request token  Optional <code>None</code> request_token_params Keyword Parameters to request token  Optional <code>None</code> required_groups List [Keyword] The groups the JWT must contain in order to allow access  Yes <code>[]</code> role_map Mapping [Keyword] A mapping of OAuth groups to howler roles  Yes <code>{}</code> access_token_url Keyword URL to get access token  Optional <code>None</code> access_token_params Keyword Parameters to get access token  Optional <code>None</code> authorize_params Keyword Parameters used to authorize access to a resource  Optional <code>None</code> api_base_url Keyword Base URL for downloading the user's and groups info  Optional <code>None</code> audience Keyword The audience to validate against. Only must be set if audience is different than the client id.  Optional <code>None</code> scope Keyword The scope to validate against  Yes <code>None</code> picture_url Keyword URL for downloading the user's profile  Optional <code>None</code> groups_url Keyword URL for accessing additional data about the user's groups  Optional <code>None</code> groups_key Keyword Path to the list of groups in the response returned from groups_url  Optional <code>None</code> iss Keyword Optional issuer field for JWT validation  Optional <code>None</code> jwks_uri Keyword URL used to verify if a returned JWKS token is valid  Yes <code>None</code> user_get Keyword Path from the base_url to fetch the user info  Optional <code>None</code>"},{"location":"installation/configuration/#passwordrequirement","title":"PasswordRequirement","text":"<p>Password Requirement</p> Field Type Description Required Default lower Boolean Password must contain lowercase letters  Yes <code>None</code> number Boolean Password must contain numbers  Yes <code>None</code> special Boolean Password must contain special characters  Yes <code>None</code> upper Boolean Password must contain uppercase letters  Yes <code>None</code> min_length Integer Minimum password length  Yes <code>None</code>"},{"location":"installation/configuration/#redis","title":"Redis","text":"<p>Redis Configuration</p> Field Type Description Required Default nonpersistent RedisServer A volatile Redis instance  Yes See RedisServer for more details. persistent RedisServer A persistent Redis instance  Yes See RedisServer for more details."},{"location":"installation/configuration/#redisserver","title":"RedisServer","text":"<p>Redis Service configuration</p> Field Type Description Required Default host Keyword Hostname of Redis instance  Yes <code>None</code> port Integer Port of Redis instance  Yes <code>None</code>"},{"location":"installation/configuration/#retention","title":"Retention","text":"<p>Retention Configuration</p> Field Type Description Required Default enabled Boolean Whether to enable the hit retention limit. If enabled, hits will be purged after the specified duration.  Yes <code>True</code> limit_unit Enum The unit to use when computing the retention limitValues:<code>\"days\", \"hours\", \"microseconds\", \"milliseconds\", \"minutes\", \"seconds\", \"weeks\"</code>  Yes <code>days</code> limit_amount Integer The number of limit_units to use when computing the retention limit  Yes <code>350</code> crontab Keyword The crontab that denotes how often to run the retention job  Yes <code>0 0 * * *</code>"},{"location":"installation/configuration/#system","title":"System","text":"<p>System Configuration</p> Field Type Description Required Default type Enum Type of systemValues:<code>\"development\", \"production\", \"staging\"</code>  Yes <code>None</code> retention Retention Retention Configuration  Yes See Retention for more details."},{"location":"installation/configuration/#ui","title":"UI","text":"<p>UI Configuration</p> Field Type Description Required Default audit Boolean Should API calls be audited and saved to a separate log file?  Yes <code>None</code> banner Mapping [Keyword] Banner message display on the main page (format: {: message})  Optional <code>None</code> banner_level Enum Banner message levelValues:<code>\"error\", \"info\", \"success\", \"warning\"</code>  Yes <code>None</code> debug Boolean Enable debugging?  Yes <code>None</code> static_folder Keyword The directory where static assets are stored.  Optional <code>None</code> discover_url Keyword Discover URL  Optional <code>None</code> email Email Assemblyline admins email address  Optional <code>None</code> enforce_quota Boolean Enforce the user's quotas?  Yes <code>None</code> secret_key Keyword Flask secret key to store cookies, etc.  Yes <code>None</code> validate_session_ip Boolean Validate if the session IP matches the IP the session was created from  Yes <code>None</code> validate_session_useragent Boolean Validate if the session useragent matches the useragent the session was created with  Yes <code>None</code> websocket_url Keyword The url to hit when emitting websocket events on the cluster  Optional <code>None</code>"},{"location":"installation/default_configuration/","title":"Default Configuration","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p> <p>Below is the default configuration for Howler. You can use it as a starting point for your installation. For more information, see Configuration.</p> <pre><code>auth:\n  allow_apikeys: true\n  allow_extended_apikeys: true\n  internal:\n    enabled: true\n    failure_ttl: 60\n    max_failures: 5\n    password_requirements:\n      lower: false\n      min_length: 12\n      number: false\n      special: false\n      upper: false\n  oauth:\n    enabled: false\n    gravatar_enabled: true\n    providers: {}\n    strict_apikeys: false\ncore:\n  metrics:\n    apm_server:\n      server_url: null\n      token: null\n  redis:\n    nonpersistent:\n      host: 127.0.0.1\n      port: 6379\n    persistent:\n      host: 127.0.0.1\n      port: 6380\ndatastore:\n  hosts:\n  - host: localhost:9200\n    name: elastic\n    password: devpass\n    scheme: http\n    username: elastic\n  ilm:\n    days_until_archive: 15\n    enabled: false\n    indexes: {}\n    update_archive: false\n  type: elasticsearch\nlogging:\n  export_interval: 5\n  log_as_json: true\n  log_directory: /var/log/howler/\n  log_level: INFO\n  log_to_console: true\n  log_to_file: false\n  log_to_syslog: false\n  syslog_host: localhost\n  syslog_port: 514\nsystem:\n  retention:\n    crontab: 0 0 * * *\n    enabled: true\n    limit_amount: 350\n    limit_unit: days\n  type: development\nui:\n  audit: true\n  banner: null\n  banner_level: info\n  debug: false\n  discover_url: null\n  email: null\n  enforce_quota: true\n  secret_key: This is the default flask secret key... you should change this!\n  static_folder: /example_dir/howler-api/howler/odm/models/../../../static\n  validate_session_ip: true\n  validate_session_useragent: true\n</code></pre>"},{"location":"installation/deployment/","title":"Deploying Howler","text":"<p>Internally at the Cyber Centre, we use a helm chart to deploy howler to a kubernetes cluster. An open source version of this chart is available on GitHub. This article consists of a general discussion of dependencies. For an example of this helm chart in use, see Installing Howler on a New Ubuntu VM.</p>"},{"location":"installation/deployment/#dependencies","title":"Dependencies","text":"<p>Howler has dependencies on a number of other applications for its functionality:</p> <ol> <li>Elasticsearch 8 (Configuration)</li> <li>Two redis instances (Configuration)<ol> <li>A persistent instance</li> <li>A non-persistent instance</li> </ol> </li> <li>A minio server (Setup under FileStore as a host, see the default configuration for an example)</li> <li>(Optional) An OAuth provider Google, Microsoft, Keycloak, etc.</li> </ol> <p>So whatever platform you wish to run Howler one, it's important it has access to these dependencies. Internally, these dependencies reside inside the same namespace as the main Howler pods.</p>"},{"location":"installation/deployment/#building-the-image","title":"Building the Image","text":"<p>Currently, although the docker image for Howler is open source, there are no public images available. Therefore, manual building is necessary:</p> <pre><code>cd ~/repos/howler-api/docker\n./build_container.sh\n</code></pre> <p>This will create a new image with the tags <code>cccs/howler-api:latest</code> and <code>cccs/howler-api:$version</code>, where <code>$version</code> is the version specified in howler's <code>setup.py</code>.</p>"},{"location":"installation/deployment/#configuring-oauth","title":"Configuring OAuth","text":"<p>In order to get OAuth authentication working, you need to configure the provider in Howler's <code>config.yml</code>. Below is a snippet explaining a sample configuration for connecting to a Keycloak server. Howler uses JSON Web Tokens for authentication in the case of OAuth.</p> <pre><code>auth:\n    # Other auth configuration here\n    oauth:\n        enabled: true\n        providers:\n            # Naming the provider\n            keycloak:\n\n                # The audience that should be accepted in the JWT\n                # https://datatracker.ietf.org/doc/html/rfc7519#section-4.1.3\n                audience: howler\n\n                # Should user data be synchronized on login with Howler?\n                auto_sync: true\n\n                # Where to connect to in order to fetch a token\n                access_token_url: https://example.com/realms/keycloak-realm/protocol/openid-connect/token\n\n                # The base URL of the OAuth provider, used for validation\n                api_base_url: https://example.com/realms/keycloak-realm/protocol/openid-connect/\n\n                # The client id and secret of the application in the OAuth provider\n                # https://www.oauth.com/oauth2-servers/client-registration/client-id-secret/\n                client_id: howler\n                client_secret: super_secret_key\n\n                # The scope denoting what data Howler will have access to on successful authentication\n                # https://oauth.net/2/scope/\n                scope: \"openid offline_access\"\n\n                # Where to fetch the keys necessary to validate the JWT returned from the server.\n                # https://auth0.com/docs/secure/tokens/json-web-tokens/json-web-key-sets\n                jwks_uri: https://example.com/realms/keycloak-realm/protocol/openid-connect/certs\n\n                # What groups the user must be a member of in order to have access to howler?\n                required_groups:\n                - howler_user\n\n                # What do the groups the user is a member of map to in terms of roles in Howler?\n                role_map:\n                    user: howler_user\n                    admin: howler_admin\n                    automation_basic: howler_admin\n                    automation_advanced: howler_admin\n</code></pre>"},{"location":"installation/deployment_minikube/","title":"Installing Howler on a New Ubuntu VM","text":"<p>This setup document allows you to setup Howler and its dependencies on a new, standalone ubuntu distribution. While a dedicated kubernetes cluster is likely a better way to handle deployments, this approach is useful if you have only a single machine available.</p>"},{"location":"installation/deployment_minikube/#install-minikube-and-dependencies","title":"Install Minikube and Dependencies","text":"<p>In order to configure and run the minikube cluster, we need to install docker, minikube, kubectl, helm and k9s.</p> <pre><code># Install Docker\nsudo apt update\nsudo apt install -y docker.io\nsudo systemctl enable docker\nsudo systemctl start docker\nsudo docker run hello-world\nsudo usermod -aG docker $USER &amp;&amp; newgrp docker\n\n# Install minikube\ncurl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\nsudo install minikube-linux-amd64 /usr/local/bin/minikube\nminikube addons enable ingress\n\n# Install kubectl\n# https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/\ncurl -LO \"https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl\"\ncurl -LO \"https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256\"\necho \"$(cat kubectl.sha256)  kubectl\" | sha256sum --check\nsudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl\nkubectl version --client\n\n# Install helm\ncurl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3\nchmod 700 get_helm.sh\n./get_helm.sh\n\n# Install k9s\ncurl -sS https://webinstall.dev/k9s | bash\nsource ~/.config/envman/PATH.env\n</code></pre>"},{"location":"installation/deployment_minikube/#install-build-dependencies-and-build-images","title":"Install Build Dependencies and Build Images","text":"<p>Since there are currently no public builds of the Howler docker image, you'll need to build them either ahead of time or on the machine.</p> <p>We will first install the build dependencies:</p> <pre><code># Install nvm\ncurl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash\n\n# You can skip these commands if you restart your shell\nexport NVM_DIR=\"$HOME/.nvm\"\n[ -s \"$NVM_DIR/nvm.sh\" ] &amp;&amp; \\. \"$NVM_DIR/nvm.sh\"                   # This loads nvm\n[ -s \"$NVM_DIR/bash_completion\" ] &amp;&amp; \\. \"$NVM_DIR/bash_completion\" # This loads nvm bash_completion\n\n# Install and use node version 20\nnvm install v20\nnvm use v20\n\n# Install the build programs\nnpm install -g yarn vite\n\n# Install Python 3.9\nsudo apt install software-properties-common\nsudo add-apt-repository ppa:deadsnakes/ppa\nsudo apt update\nsudo apt install python3.9 python3.9-distutils python3.9-venv\nsudo update-alternatives --install /usr/bin/python python /usr/bin/python3.9 1\npython -m ensurepip\npython -m pip install wheel\n</code></pre> <p>Now we can clone and build the images:</p> <pre><code># Clone the howler repositories\nmkdir ~/repos &amp;&amp; cd ~/repos\ngit clone git@github.com:CybercentreCanada/howler-api.git\ngit clone git@github.com:CybercentreCanada/howler-ui.git\n\n# Build howler-api docker image\ncd ~/repos/howler-api/docker\n./build_container.sh\n\ncd ~/repos/howler-ui/docker\n./build_container.sh\n</code></pre> <p>Now we can start and configure the minikube deployment:</p> <pre><code># Upload the images to minikube (this takes a while)\nminikube image load cccs/howler-ui:latest\nminikube image load cccs/howler-api:latest\n\nminikube start\n\n# Input the yml below\nvim minio-credentials.yml\nkubectl apply -f minio-credentials.yml\n\n# Create the interpod secret\nkubectl create secret generic howler-interpod-comms-secret\n  --from-literal=secret=\"&lt;INTERPOD_COMMS_SECRET&gt;\"\n\n# Clone the howler repository, to get the helm chart\ngit clone git@github.com:CybercentreCanada/howler.git\ncd howler/howler-helm\n\n# Install the howler helm chart\nhelm install howler .\n\n# Check that everything loads correctly\nk9s\n\n# After everything loads, can we access the ingress?\ncurl $(minikube ip)\n\n# Install and configure nginx\nsudo apt install nginx\nsudo rm /etc/nginx/sites-enabled/default\n\n# Input the conf file below\nsudo vim /etc/nginx/site-enabled/howler\n\nsudo service nginx restart\n\n# Is nginx working?\ncurl localhost\n</code></pre> <p>At this point, you should have an open port 80 on your machine serving a functional howler instance.</p>"},{"location":"installation/deployment_minikube/#required-files","title":"Required Files","text":"<p>minio-credentials.yml:</p> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: minio-credentials\n  annotations:\n    \"helm.sh/resource-policy\": \"keep\"\ndata:\n  root-user: &lt;SOME_USERNAME&gt;\n  root-password: &lt;SOME_PASSWORD&gt;\n</code></pre> <p>nginx configuration:</p> <pre><code>server {\n    listen 80 default_server;\n    sendfile on;\n    server_name howler;\n\n    location / {\n        proxy_pass http://&lt;MINIKUBE_IP&gt;;\n        proxy_set_header Host $host:$server_port;\n    }\n}\n</code></pre>"},{"location":"odm/getting_started/","title":"Howler ODM Documentation","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p> <p>This section of the site is useful for deciding what fields to place your raw data in when ingesting into Howler.</p>"},{"location":"odm/getting_started/#basic-field-types","title":"Basic Field Types","text":"<p>Here is a table of the basic types of fields in our data models and what they're used for:</p> Name Description <code>Any</code> A field that can hold any value whatsoever but which is stored as a <code>Boolean</code> A field storing a boolean value. <code>Classification</code> A field storing access control classification. <code>ClassificationString</code> A field storing the classification as a string only. <code>Date</code> A field storing a datetime value. <code>EmptyableKeyword</code> A keyword which allow to differentiate between empty and None values. <code>Enum</code> A field storing a short string that has predefined list of possible values <code>FlattenedListObject</code> A field storing a flattened object <code>FlattenedObject</code> A field storing a flattened object <code>Float</code> A field storing a floating point value. <code>IndexText</code> A special field with special processing rules to simplify searching. <code>Integer</code> A field storing an integer value. <code>Json</code> A field storing serializeable structure with their JSON encoded representations. <code>Keyword</code> A field storing a short string with a technical interpretation. <code>List</code> A field storing a sequence of typed elements. <code>Mapping</code> A field storing a sequence of typed elements. <code>Optional</code> A wrapper field to allow simple types (int, float, bool) to take None values. <code>Text</code> A field storing human readable text data. <code>UUID</code> A field storing an auto-generated unique ID if None is provided <code>UpperKeyword</code> A field storing a short uppercase string with a technical interpretation. <code>ValidatedKeyword</code> Keyword field which the values are validated by a regular expression"},{"location":"odm/getting_started/#field-states","title":"Field States","text":"<p>In each table, there will be a \"Required\" column with different states about the field's status:</p> State Description  Yes This field is required to be set in the model  Optional This field isn't required to be set in the model  Deprecated This field has been deprecated in the model. See field's description for more details. <p>Note: Fields that are \" Deprecated\" that are still shown in the docs will still work as expected but you're encouraged to update your configuration as soon as possible to avoid future deployment issues.</p>"},{"location":"odm/class/account/","title":"Account","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/account/#account","title":"Account","text":"<p>Cloud account information.</p> Field Type Description Required Default id Keyword The ID of the AWS Account.  Optional <code>None</code> name Keyword The name of the AWS Account.  Optional <code>None</code>"},{"location":"odm/class/address/","title":"Address","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/address/#address","title":"Address","text":"<p>The email Address</p> Field Type Description Required Default address Email The email address.  Yes <code>None</code>"},{"location":"odm/class/agent/","title":"Agent","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/agent/#agent","title":"Agent","text":"<p>The agent fields contain the data about the software entity, if any, that collects, detects, or observes events on a host, or takes measurements on a host.</p> Field Type Description Required Default id Keyword Unique identifier of this agent (if one exists).  Optional <code>None</code> name Keyword Custom name of the agent.  Optional <code>None</code> type Keyword Type of the agent.  Optional <code>None</code> version Keyword Version of the agent.  Optional <code>None</code>"},{"location":"odm/class/assemblyline/","title":"Assemblyline","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/assemblyline/#assemblyline","title":"AssemblyLine","text":"<p>The AssemblyLine fields contain any data obtained from AssemblyLine relating to the alert.</p> Field Type Description Required Default antivirus List [ALRecord] None  Yes <code>[]</code> attribution List [ALRecord] None  Yes <code>[]</code> behaviour List [ALRecord] None  Yes <code>[]</code> domain List [ALRecord] None  Yes <code>[]</code> heuristic List [ALRecord] None  Yes <code>[]</code> mitre Mitre None  Optional See Mitre for more details. uri List [ALRecord] None  Yes <code>[]</code> yara List [ALRecord] None  Yes <code>[]</code>"},{"location":"odm/class/attachment/","title":"Attachment","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/attachment/#attachment","title":"Attachment","text":"<p>An attachment file sent along with an email message.</p> Field Type Description Required Default file File Information about the file sent.  Optional <code>None</code>"},{"location":"odm/class/aws/","title":"Aws","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/aws/#aws","title":"AWS","text":"<p>Fields related to AWS.</p> Field Type Description Required Default account Account AWS account information.  Optional <code>None</code> organization Organization Organization information.  Optional <code>None</code>"},{"location":"odm/class/azure/","title":"Azure","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/azure/#azure","title":"Azure","text":"<p>Fields related to Azure.</p> Field Type Description Required Default subscription_id Keyword The unique identifier for the Azure subscription.  Optional <code>None</code> tenant_id Keyword The unique identifier for the Azure tenant.  Optional <code>None</code> resource_group Keyword The name of the Azure resource group.  Optional <code>None</code> upn Keyword The user principal name (UPN) in Azure, used for authentication. Alias of user.name.  Optional <code>None</code> resource_id Keyword The unique Azure Resource Identifier (AzureRI).  Optional <code>None</code>"},{"location":"odm/class/body/","title":"Body","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/body/#body","title":"Body","text":"<p>Defines the body of a request/response.</p> Field Type Description Required Default bytes Integer Size in bytes of the body.  Optional <code>None</code> content Keyword The full HTTP body.  Optional <code>None</code>"},{"location":"odm/class/cbs/","title":"Cbs","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/cbs/#cbs","title":"CBS","text":"<p>The cbs fields contain any data obtained from CBS relating to the alert.</p> Field Type Description Required Default sharepoint Sharepoint Sharepoint metadata  Optional <code>None</code>"},{"location":"odm/class/chardevice/","title":"Chardevice","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/chardevice/#chardevice","title":"CharDevice","text":"<p>Information about the char device.</p> Field Type Description Required Default major Integer The major number identifies the driver associated with the device.  Optional <code>None</code> minor Integer The minor number is used only by the driver specified by the major number; other parts of the kernel don\u2019t use it, and merely pass it along to the driver.  Optional <code>None</code>"},{"location":"odm/class/client/","title":"Client","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/client/#client","title":"Client","text":"<p>A client is defined as the initiator of a network connection for events regarding sessions, connections, or bidirectional flow records.</p> Field Type Description Required Default address Keyword Some event client addresses are defined ambiguously. The event will sometimes list an IP, a domain or a unix socket. You should always store the raw address in the .address field.  Optional <code>None</code> bytes Integer Bytes sent from the client to the server.  Optional <code>None</code> domain Domain The domain name of the client system.  Optional <code>None</code> geo Geo Geo fields can carry data about a specific location related to an event.  Optional <code>None</code> ip IP IP address of the client (IPv4 or IPv6).  Optional <code>None</code> mac MAC MAC address of the client.  Optional <code>None</code> nat Nat Translated NAT sessions (e.g. internal client to internet).  Optional <code>None</code> packets Integer Packets sent from the destination to the source.  Optional <code>None</code> port Integer Port of the client.  Optional <code>None</code>"},{"location":"odm/class/cloud/","title":"Cloud","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/cloud/#cloud","title":"Cloud","text":"<p>Fields related to the cloud or infrastructure the events are coming from.</p> Field Type Description Required Default account Account Cloud account information.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code> availability_zone Keyword Availability zone in which this host, resource, or service is located.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code> instance Instance Instance information.  Optional <code>None</code> machine Machine Machine information.  Optional <code>None</code> project Project Project information.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code> provider Keyword Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.  Optional <code>None</code> region Keyword Region in which this host, resource, or service is located.  Optional <code>None</code> service Service Service information.  Optional <code>None</code> tenant_id Keyword The tenant id associated with this alert.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code>"},{"location":"odm/class/codesignature/","title":"Codesignature","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/codesignature/#codesignature","title":"CodeSignature","text":"<p>These fields contain information about binary code signatures.</p> Field Type Description Required Default digest_algorithm Enum The hashing algorithm used to sign the process.Values:<code>\"md5\", \"sha1\", \"sha256\", \"sha384\", \"sha512\"</code>  Optional <code>None</code> exists Boolean Boolean to capture if a signature is present.  Optional <code>None</code> signing_id Keyword The identifier used to sign the process.  Optional <code>None</code> status Keyword Additional information about the certificate status.  Optional <code>None</code> subject_name Keyword Subject name of the code signer.  Optional <code>None</code> team_id Keyword The team identifier used to sign the process.  Optional <code>None</code> timestamp Date Date and time when the code signature was generated and signed.  Optional <code>None</code> trusted Boolean Stores the trust status of the certificate chain.  Optional <code>None</code> valid Boolean Boolean to capture if the digital signature is verified against the binary content.  Optional <code>None</code>"},{"location":"odm/class/comment/","title":"Comment","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/comment/#comment","title":"Comment","text":"<p>Comment definition.</p> Field Type Description Required Default id UUID A unique ID for the comment.  Yes <code>None</code> timestamp Date Timestamp at which the comment took place.  Yes <code>NOW</code> modified Date Timestamp at which the comment was last edited.  Yes <code>NOW</code> value Text The comment itself.  Yes <code>None</code> user Keyword User ID who created the comment.  Yes <code>None</code> reactions Mapping [Keyword] A list of reactions to the comment.  Yes <code>{}</code>"},{"location":"odm/class/container/","title":"Container","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/container/#container","title":"Container","text":"<p>Fields related to the cloud or infrastructure the events are coming from.</p> Field Type Description Required Default id Keyword Unique container id.  Optional <code>None</code> image Image Cloud account information.  Optional <code>None</code> labels Mapping [Keyword] Image labels.  Optional <code>None</code> name Keyword Container name.  Optional <code>None</code> runtime Keyword Runtime managing this container.  Optional <code>None</code>"},{"location":"odm/class/device/","title":"Device","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/device/#device","title":"Device","text":"<p>Information about the device.</p> Field Type Description Required Default name Keyword Name of the device.  Optional <code>None</code>"},{"location":"odm/class/dns/","title":"Dns","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/dns/#dns","title":"DNS","text":"<p>Fields describing DNS queries and answers.</p> Field Type Description Required Default answers List [DNSAnswer] An array containing an object for each answer section returned by the server.  Optional <code>None</code> header_flags List [Keyword] Array of 2 letter DNS header flags.  Optional <code>None</code> id Keyword The DNS packet identifier assigned by the program that generated the query.  Optional <code>None</code> op_code Keyword The DNS operation code that specifies the kind of query in the message.  Optional <code>None</code> question DNSQuestion An object encapsulating the question asked to the server.  Optional <code>None</code> resolved_ip List [IP] Array containing all IPs seen in answers.data.  Optional <code>None</code> response_code Keyword The DNS response code.  Optional <code>None</code> type Keyword The type of DNS event captured, query or answer.  Optional <code>None</code>"},{"location":"odm/class/dnsanswer/","title":"Dnsanswer","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/dnsanswer/#dnsanswer","title":"DNSAnswer","text":"<p>An answer section returned by the server.</p> Field Type Description Required Default class Keyword The class of DNS data contained in this resource record.  Optional <code>None</code> data Keyword The data describing the resource.  Optional <code>None</code> name Keyword The domain name to which this resource record pertains.  Optional <code>None</code> ttl Integer The time interval in seconds that this resource record may be cached before it should be discarded.  Optional <code>None</code> type Keyword The type of data contained in this resource record.  Optional <code>None</code>"},{"location":"odm/class/dnsquestion/","title":"Dnsquestion","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/dnsquestion/#dnsquestion","title":"DNSQuestion","text":"<p>An object encapsulating the question asked to the server.</p> Field Type Description Required Default class Keyword The class of records being queried.  Optional <code>None</code> name Keyword The name being queried.  Optional <code>None</code> registered_domain Domain The highest registered domain, stripped of the subdomain.  Optional <code>None</code> subdomain Keyword The subdomain is all of the labels under the registered_domain.  Optional <code>None</code> top_level_domain Keyword The effective top level domain (eTLD), also known as the domain suffix, is the last part of the domain name.  Optional <code>None</code> type Keyword The type of record being queried.  Optional <code>None</code>"},{"location":"odm/class/ecsversion/","title":"Ecsversion","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/ecsversion/#ecsversion","title":"ECSVersion","text":"<p>ECS model version</p> Field Type Description Required Default version Keyword Additional information about the certificate status.  Yes <code>8.3.0</code>"},{"location":"odm/class/elf/","title":"Elf","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/elf/#elf","title":"ELF","text":"<p>These fields contain Linux Executable Linkable Format (ELF) metadata.</p> Field Type Description Required Default architecture Keyword Machine architecture of the ELF file.  Optional <code>None</code> byte_order Keyword Byte sequence of ELF file.  Optional <code>None</code> cpu_type Keyword CPU type of the ELF file.  Optional <code>None</code> creation_date Keyword Extracted when possible from the file\u2019s metadata.  Optional <code>None</code> exports List [Keyword] List of exported element names and types.  Yes <code>[]</code> header Header Header information about the ELF file.  Optional <code>None</code> imports List [Keyword] List of imported element names and types.  Optional <code>None</code> sections List [Section] None  Optional <code>None</code> segments List [Section] None  Optional <code>None</code> shared_libraries List [Keyword] List of shared libraries used by this ELF object.  Optional <code>None</code> telfhash Keyword telfhash symbol hash for ELF file.  Optional <code>None</code>"},{"location":"odm/class/email/","title":"Email","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/email/#email","title":"Email","text":"<p>Event details relating to an email transaction.</p> Field Type Description Required Default attachments List [Attachment] None  Optional <code>None</code> bcc Address The email address of BCC recipient.  Optional <code>None</code> cc Address The email address of CC recipient.  Optional <code>None</code> content_type Keyword Information about how the message is to be displayed.  Optional <code>None</code> delivery_timestamp Date The date and time when the email message was received by the service or client.  Optional <code>None</code> direction Keyword The direction of the message based on the sending and receiving domains.  Optional <code>None</code> from Address The email address of the sender, typically from the RFC 5322 From: header field.  Optional <code>None</code> local_id Keyword Unique identifier given to the email by the source that created the event.  Optional <code>None</code> message_id Keyword Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message.  Optional <code>None</code> origination_timestamp Date The date and time the email message was composed.  Optional <code>None</code> reply_to Address The address that replies should be delivered to based on the value in the RFC 5322 Reply-To: header.  Optional <code>None</code> sender Address Per RFC 5322, specifies the address responsible for the actual transmission of the message.  Optional <code>None</code> subject Keyword A brief summary of the topic of the message.  Optional <code>None</code> to Address The email address of recipient.  Optional <code>None</code> x_mailer Keyword The name of the application that was used to draft and send the original email message.  Optional <code>None</code> parent ParentEmail Metadata about the parent email.  Optional <code>None</code>"},{"location":"odm/class/error/","title":"Error","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/error/#error","title":"Error","text":"<p>These fields can represent errors of any kind. Use them for errors that happen while fetching events or in cases where the event itself contains an error.</p> Field Type Description Required Default code Keyword Identifier specific to the error.  Optional <code>None</code> message Keyword Error message provided.  Optional <code>None</code>"},{"location":"odm/class/event/","title":"Event","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/event/#event","title":"Event","text":"<p>The event fields are used for context information about the log or metric event itself.</p> Field Type Description Required Default action Keyword The action captured by the event.  Optional <code>None</code> category List [Enum] Represents the \"big buckets\" of ECS categories. For example, filtering on event.category:process yields all events relating to process activity. This field is closely related to event.type, which is used as a subcategory.  Optional <code>None</code> code Keyword Identification code for this event, if one exists.  Optional <code>None</code> created Date Contains the date/time when the event was first read by an agent, or by your pipeline.  Optional <code>None</code> dataset Keyword Name of the dataset.  Optional <code>None</code> duration Integer Duration of the event in nanoseconds.  Optional <code>None</code> end Date Contains the date when the event ended or when the activity was last observed.  Optional <code>None</code> hash Keyword Hash (perhaps logstash fingerprint) of raw field to be able to demonstrate log integrity.  Optional <code>None</code> id Keyword Unique ID to describe the event.  Optional <code>None</code> ingested Date Timestamp when an event arrived in the central data store.  Yes <code>NOW</code> kind Enum Gives high-level information about what type of information the event contains, without being specific to the contents of the event. Values:<code>\"alert\", \"enrichment\", \"event\", \"metric\", \"pipeline_error\", \"signal\", \"state\"</code>  Optional <code>None</code> module Keyword Name of the module this data is coming from.  Optional <code>None</code> original Keyword Raw text message of entire event. Used to demonstrate log integrity or where the full log message (before splitting it up in multiple parts) may be required, e.g. for reindex.  Optional <code>None</code> outcome Enum Simply denotes whether the event represents a success or a failure from the perspective of the entity that produced the event.Values:<code>\"failure\", \"success\", \"unknown\"</code>  Optional <code>None</code> provider Keyword Source of the event.  Optional <code>None</code> reason Keyword Reason why this event happened, according to the source.  Optional <code>None</code> reference Keyword Reference URL linking to additional information about this event.  Optional <code>None</code> risk_score Float Risk score or priority of the event (e.g. security solutions).  Optional <code>None</code> risk_score_norm Float Normalized risk score or priority of the event, on a scale of 0 to 100.  Optional <code>None</code> sequence Integer Sequence number of the event.  Optional <code>None</code> severity Integer The numeric severity of the event according to your event source.  Optional <code>None</code> start Date Contains the date when the event started or when the activity was first observed.  Optional <code>None</code> timezone Keyword This field should be populated when the event\u2019s timestamp does not include timezone information already (e.g. default Syslog timestamps).  Optional <code>None</code> type List [Enum] Represents a categorization \"sub-bucket\" that, when used along with the event.category field values, enables filtering events down to a level appropriate for single visualization.  Optional <code>None</code> url Keyword URL linking to an external system to continue investigation of this event.  Optional <code>None</code>"},{"location":"odm/class/faas/","title":"Faas","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/faas/#faas","title":"FAAS","text":"<p>The user fields describe information about the function as a service (FaaS) that is relevant to the event.</p> Field Type Description Required Default coldstart Boolean Boolean value indicating a cold start of a function.  Optional <code>None</code> execution Keyword The execution ID of the current function execution.  Optional <code>None</code> id Keyword The unique identifier of a serverless function.  Optional <code>None</code> name Keyword The name of a serverless function.  Optional <code>None</code> trigger Trigger Details about the function trigger.  Optional <code>None</code> version Keyword The version of a serverless function.  Optional <code>None</code>"},{"location":"odm/class/feed/","title":"Feed","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/feed/#feed","title":"Feed","text":"<p>Threat feed information.</p> Field Type Description Required Default dashboard_id Keyword The saved object ID of the dashboard belonging to the threat feed for displaying dashboard links to threat feeds in Kibana.  Optional <code>None</code> description Keyword Description of the threat feed in a UI friendly format.  Optional <code>None</code> name Keyword The name of the threat feed in UI friendly format.  Optional <code>None</code> reference Keyword Reference information for the threat feed in a UI friendly format.  Optional <code>None</code>"},{"location":"odm/class/file/","title":"File","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/file/#file","title":"File","text":"<p>A file is defined as a set of information that has been created on, or has existed on a filesystem.</p> Field Type Description Required Default accessed Date Last time the file was accessed.  Optional <code>None</code> attributes List [Keyword] Array of file attributes.  Optional <code>None</code> created Date File creation time.  Optional <code>None</code> ctime Date Last time the file attributes or metadata changed.  Optional <code>None</code> device Keyword Device that is the source of the file.  Optional <code>None</code> directory Keyword Directory where the file is located. It should include the drive letter, when appropriate.  Optional <code>None</code> drive_letter Keyword Drive letter where the file is located. This field is only relevant on Windows.  Optional <code>None</code> extension Keyword File extension, excluding the leading dot.  Optional <code>None</code> fork_name Keyword A fork is additional data associated with a filesystem object.  Optional <code>None</code> gid Keyword Primary group ID (GID) of the file.  Optional <code>None</code> group Keyword Primary group name of the file.  Optional <code>None</code> inode Keyword Inode representing the file in the filesystem.  Optional <code>None</code> mime_type Keyword MIME type should identify the format of the file or stream of bytes using IANA official types, where possible.  Optional <code>None</code> mode Keyword Mode of the file in octal representation.  Optional <code>None</code> mtime Date Last time the file content was modified.  Optional <code>None</code> name Keyword Name of the file including the extension, without the directory.  Optional <code>None</code> owner Keyword File owner\u2019s username.  Optional <code>None</code> path Keyword Full path to the file, including the file name. It should include the drive letter, when appropriate.  Optional <code>None</code> size Integer File size in bytes.  Optional <code>None</code> target_path Keyword Target path for symlinks.  Optional <code>None</code> type Enum File type (file, dir, or symlink).Values:<code>\"dir\", \"file\", \"symlink\"</code>  Optional <code>None</code> uid Keyword The user ID (UID) or security identifier (SID) of the file owner.  Optional <code>None</code> code_signature CodeSignature These fields contain information about binary code signatures.  Optional <code>None</code> elf ELF These fields contain Linux Executable Linkable Format (ELF) metadata.  Optional <code>None</code> hash Hashes These fields contain Windows Portable Executable (PE) metadata.  Optional <code>None</code> pe PE Hashes, usually file hashes.  Optional <code>None</code>"},{"location":"odm/class/gcp/","title":"Gcp","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/gcp/#gcp","title":"GCP","text":"<p>Fields related to Google Cloud Platform.</p> Field Type Description Required Default project_id Keyword The unique identifier for the GCP project.  Optional <code>None</code> network_id Keyword The unique identifier for a Google Cloud Platform (GCP) network.  Optional <code>None</code> zone Keyword The GCP zone of the instance.  Optional <code>None</code> service_account_id Keyword Unique identifier for a GCP service account.  Optional <code>None</code> resource_id Keyword Unique GCP resource identifier.  Optional <code>None</code>"},{"location":"odm/class/geo/","title":"Geo","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/geo/#geo","title":"Geo","text":"<p>Geo fields can carry data about a specific location related to an event.</p> Field Type Description Required Default city_name Keyword City name.  Optional <code>None</code> continent_code Keyword Two-letter code representing continent\u2019s name.  Optional <code>None</code> continent_name Keyword Name of the continent.  Optional <code>None</code> country_iso_code Keyword Country ISO code.  Optional <code>None</code> country_name Keyword Country name.  Optional <code>None</code> location GeoPoint Longitude and latitude.  Optional <code>None</code> name Keyword User-defined description of a location, at the level of granularity they care about.  Optional <code>None</code> postal_code Keyword Postal code associated with the location.  Optional <code>None</code> region_iso_code Keyword City name.  Optional <code>None</code> region_name Keyword Region name.  Optional <code>None</code> timezone Keyword The time zone of the location, such as IANA time zone name.  Optional <code>None</code>"},{"location":"odm/class/geopoint/","title":"Geopoint","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/geopoint/#geopoint","title":"GeoPoint","text":"<p>Longitude and latitude.</p> Field Type Description Required Default lon Float Longitude  Yes <code>None</code> lat Float Latitude  Yes <code>None</code>"},{"location":"odm/class/group/","title":"Group","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/group/#group","title":"Group","text":"<p>The group fields are meant to represent groups that are relevant to the event.</p> Field Type Description Required Default domain Keyword Name of the directory the group is a member of.  Optional <code>None</code> id Keyword Unique identifier for the group on the system/platform.  Optional <code>None</code> name Keyword Name of the group.  Optional <code>None</code>"},{"location":"odm/class/hash/","title":"Hash","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/hash/#hash","title":"Hash","text":"<p>Container hashes information.</p> Field Type Description Required Default all List [Keyword] An array of digests of the image the container was built on.  Yes <code>[]</code>"},{"location":"odm/class/hashes/","title":"Hashes","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/hashes/#hashes","title":"Hashes","text":"<p>The hash fields represent different bitwise hash algorithms and their values.</p> Field Type Description Required Default md5 MD5 MD5 hash.  Optional <code>None</code> sha1 SHA1 SHA1 hash.  Optional <code>None</code> sha256 SHA256 SHA256 hash.  Optional <code>None</code> sha384 ValidatedKeyword SHA384 hash.  Optional <code>None</code> sha512 ValidatedKeyword SHA512 hash.  Optional <code>None</code> ssdeep SSDeepHash SSDEEP hash.  Optional <code>None</code> tlsh Keyword TLSH hash.  Optional <code>None</code>"},{"location":"odm/class/header/","title":"Header","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/header/#header","title":"Header","text":"<p>Hit outline header.</p> Field Type Description Required Default threat Text The IP of the threat.  Optional <code>None</code> target Text The target of the hit.  Optional <code>None</code> indicators List [Text] None  Yes <code>[]</code> summary Text Summary of the hit.  Optional <code>None</code>"},{"location":"odm/class/hit/","title":"Hit","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/hit/#hit","title":"Hit","text":"<p>Howler Outline schema which is an extended version of Elastic Common Schema (ECS)</p> Field Type Description Required Default timestamp Date Date/time when the event originated.Reference Link  Yes <code>NOW</code> labels Mapping [Keyword] Custom key/value pairs.Reference Link  Yes <code>{}</code> tags List [Keyword] List of keywords used to tag each event.Reference Link  Yes <code>[]</code> howler HowlerData Howler specific definition of the hit that matches the outline.Reference Link  Yes <code>None</code> assemblyline AssemblyLine AssemblyLine metadata associated with this alert.  Optional <code>None</code> agent Agent The agent fields contain the data about the software entity, if any, that collects, detects, or observes events on a host, or takes measurements on a host.Reference Link  Optional <code>None</code> aws AWS Fields related to AWS.  Optional <code>None</code> azure Azure Fields related to Azure.  Optional <code>None</code> cbs CBS CBS metadata associated with this alert.  Optional <code>None</code> cloud Cloud Fields related to the cloud or infrastructure the events are coming from.Reference Link  Optional <code>None</code> container Container Container fields are used for meta information about the specific container that is the source of information.Reference Link  Optional <code>None</code> destination Client Destination fields capture details about the receiver of a network exchange/packet.Reference Link  Optional <code>None</code> dns DNS Fields describing DNS queries and answers.Reference Link  Optional <code>None</code> ecs ECSVersion Meta-information specific to ECS.Reference Link  Yes See ECSVersion for more details. error Error These fields can represent errors of any kind.Reference Link  Optional <code>None</code> event Event The event fields are used for context information about the log or metric event itself.  Optional <code>None</code> email Email Event details relating to an email transaction.Reference Link  Optional <code>None</code> faas FAAS The user fields describe information about the function as a service (FaaS) that is relevant to the event.Reference Link  Optional <code>None</code> file File A file is defined as a set of information that has been created on, or has existed on a filesystem.Reference Link  Optional <code>None</code> gcp GCP Fields related to Google Cloud Platform.  Optional <code>None</code> group Group The group fields are meant to represent groups that are relevant to the event.Reference Link  Optional <code>None</code> host Host A host is defined as a general computing instance. ECS host.* fields should be populated with details about the host on which the event happened, or from which the measurement was taken. Host types include hardware, virtual machines, Docker containers, and Kubernetes nodes.Reference Link  Optional <code>None</code> http HTTP Fields related to HTTP activity. Use the url field set to store the url of the request.Reference Link  Optional <code>None</code> organization Organization The organization fields enrich data with information about the company or entity the data is associated with.Reference Link  Optional <code>None</code> process Process These fields contain information about a process.Reference Link  Optional <code>None</code> registry Registry Fields related to Windows Registry operations.Reference Link  Optional <code>None</code> related Related Fields related to Windows Registry operations.Reference Link  Optional <code>None</code> server Server A Server is defined as the responder in a network connection for events regarding sessions, connections, or bidirectional flow records.Reference Link  Optional <code>None</code> source Client Source fields capture details about the sender of a network exchange/packet.Reference Link  Optional <code>None</code> threat Threat Fields to classify events and alerts according to a threat taxonomy such as the MITRE ATT&amp;CK\u00ae framework.Reference Link  Optional <code>None</code> tls TLS Fields related to a TLS connection. These fields focus on the TLS protocol itself and intentionally avoids in-depth analysis of the related x.509 certificate files.Reference Link  Optional <code>None</code> url URL URL fields provide support for complete or partial URLs, and supports the breaking down into scheme, domain, path, and so on.Reference Link  Optional <code>None</code> user User The user fields describe information about the user that is relevant to the event.Reference Link  Optional <code>None</code> user_agent UserAgent The user_agent fields normally come from a browser request.Reference Link  Optional <code>None</code> vulnerability Vulnerability The vulnerability fields describe information about a vulnerability that is relevant to an event.Reference Link  Optional <code>None</code>"},{"location":"odm/class/host/","title":"Host","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/host/#host","title":"Host","text":"<p>A host is defined as a general computing instance.</p> Field Type Description Required Default id Keyword Unique host id. Use Agent ID for HBS.  Optional <code>None</code> ip List [IP] Host ip addresses.  Yes <code>[]</code> mac List [Keyword] Host MAC addresses.  Yes <code>[]</code> name Keyword Name of the host.  Optional <code>None</code> domain Keyword Domain the host is a member of.  Optional <code>None</code> type Keyword As described by CSP.  Optional <code>None</code>"},{"location":"odm/class/howlerdata/","title":"Howlerdata","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/howlerdata/#howlerdata","title":"HowlerData","text":"<p>Howler specific definition of the hit that matches the outline.</p> Field Type Description Required Default id UUID A UUID for this hit.  Yes <code>None</code> analytic Keyword Title of the analytic.  Yes <code>None</code> assignment Keyword Unique identifier of the assigned user.  Yes <code>unassigned</code> bundles List [Keyword] A list of bundle IDs this hit is a part of. Corresponds to the howler.id of the bundle.  Yes <code>[]</code> data List [Keyword] Raw telemetry records associated with this hit.  Yes <code>[]</code> links List [Link] A list of links associated with this hit.  Yes <code>[]</code> detection Keyword The detection that produced this hit.  Optional <code>None</code> hash SHA256 A hash of the event used for deduplicating hits.  Yes <code>None</code> hits List [Keyword] A list of hit IDs this bundle represents. Corresponds to the howler.id of the child hit.  Yes <code>[]</code> is_bundle Boolean Is this hit a bundle or a normal hit?  Yes <code>False</code> related List [Keyword] Related hits grouped by the enrichment that correlated them. Populated by enrichments.  Yes <code>[]</code> reliability Float Metric decoupled from the value in the detection information.  Optional <code>None</code> severity Float Metric decoupled from the value in the detection information.  Optional <code>None</code> volume Float Metric decoupled from the value in the detection information.  Optional <code>None</code> confidence Float Metric decoupled from the value in the detection information.  Optional <code>None</code> score Float A score assigned by an enrichment to help prioritize triage.  Yes <code>None</code> status Enum Status of the hit.Values:<code>\"in-progress\", \"on-hold\", \"open\", \"resolved\"</code>  Yes <code>open</code> scrutiny Enum Level of scrutiny done to this hit.Values:<code>\"inspected\", \"investigated\", \"scanned\", \"surveyed\", \"unseen\"</code>  Yes <code>unseen</code> escalation Enum Level of escalation of this hit.Values:<code>\"alert\", \"evidence\", \"hit\", \"miss\"</code>  Yes <code>hit</code> assessment Enum Assessment of the hit.Values:<code>\"ambiguous\", \"attempt\", \"compromise\", \"development\", \"false-positive\", \"legitimate\", \"mitigated\", \"recon\", \"security\", \"trivial\"</code>  Optional <code>None</code> rationale Text The rationale behind the hit assessment. Allows it to be understood and verified by other analysts.  Optional <code>None</code> comment List [Comment] A list of comments with timestamps and attribution.  Yes <code>[]</code> log List [Log] A list of changes to the hit with timestamps and attribution.  Yes <code>[]</code> retained Keyword If the hit was retained, this is a link to it in Alfred.  Optional <code>None</code> monitored Keyword Link to the incident monitoring dashboard.  Optional <code>None</code> reported Keyword Link to the incident report.  Optional <code>None</code> mitigated Keyword Link to the mitigation record (tool dependent).  Optional <code>None</code> outline Header The user specified header of the hit  Optional <code>None</code> labels Label List of labels relating to the hit  Optional See Label for more details. votes Votes Votes relating to the hit  Optional See Votes for more details. dossier FlattenedObject Raw data provided by the different sources.  Optional <code>None</code> viewers List [Keyword] A list of users currently viewing the hit  Yes <code>[]</code>"},{"location":"odm/class/http/","title":"Http","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/http/#http","title":"HTTP","text":"<p>These fields can represent errors of any kind.</p> Field Type Description Required Default request Request Request data.  Optional <code>None</code> response Response Response data.  Optional <code>None</code> version Keyword HTTP version.  Optional <code>None</code>"},{"location":"odm/class/image/","title":"Image","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/image/#image","title":"Image","text":"<p>Information about the container Image.</p> Field Type Description Required Default hash Hash Container hashes information.  Optional <code>None</code> name Keyword Name of the image the container was built on.  Optional <code>None</code> tag List [Keyword] Container image tags.  Yes <code>[]</code>"},{"location":"odm/class/indicator/","title":"Indicator","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/indicator/#indicator","title":"Indicator","text":"<p>Object containing associated indicators enriching the event.</p> Field Type Description Required Default confidence Keyword Identifies the vendor-neutral confidence rating using the None/Low/Medium/High scale defined in Appendix A of the STIX 2.1 framework. Vendor-specific confidence scales may be added as custom fields.  Optional <code>None</code> description Text Describes the type of action conducted by the threat.  Optional <code>None</code> email Email None  Optional <code>None</code> provider Keyword The name of the indicator\u2019s provider.  Optional <code>None</code> reference Keyword Reference URL linking to additional information about this indicator.  Optional <code>None</code> scanner_stats Integer Count of AV/EDR vendors that successfully detected malicious file or URL.  Optional <code>None</code> sightings Integer Number of times this indicator was observed conducting threat activity.  Optional <code>None</code> ip IP Identifies a threat indicator as an IP address (irrespective of direction).  Optional <code>None</code> type Keyword Type of indicator as represented by Cyber Observable in STIX 2.0.  Optional <code>None</code> first_seen Date The date and time when intelligence source first reported sighting this indicator.  Optional <code>None</code> last_seen Date The date and time when intelligence source last reported sighting this indicator.  Optional <code>None</code>"},{"location":"odm/class/instance/","title":"Instance","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/instance/#instance","title":"Instance","text":"<p>Instance information.</p> Field Type Description Required Default id Keyword Instance ID of the host machine.  Optional <code>None</code> name Keyword Instance name of the host machine.  Optional <code>None</code>"},{"location":"odm/class/label/","title":"Label","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/label/#label","title":"Label","text":"<p>Labels for the hit</p> Field Type Description Required Default assignments List [Text] None  Yes <code>[]</code> generic List [Text] None  Yes <code>[]</code> insight List [Text] None  Yes <code>[]</code> mitigation List [Text] None  Yes <code>[]</code> victim List [Text] None  Yes <code>[]</code> campaign List [Text] None  Yes <code>[]</code> threat List [Text] None  Yes <code>[]</code> operation List [Text] None  Yes <code>[]</code>"},{"location":"odm/class/link/","title":"Link","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/link/#link","title":"Link","text":"<p>Howler Link definition.</p> Field Type Description Required Default href Keyword Timestamp at which the comment was last edited.  Yes <code>None</code> title Text The title to use for the link.  Optional <code>None</code> icon Keyword The icon to show. Either an ID corresponding to an analytical platform application, or an external link.  Yes <code>None</code>"},{"location":"odm/class/log/","title":"Log","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/log/#log","title":"Log","text":"<p>Log definition.</p> Field Type Description Required Default timestamp Date Timestamp at which the Log event took place.  Yes <code>None</code> key Keyword The key whose value changed.  Optional <code>None</code> explanation Text A manual description of the changes made.  Optional <code>None</code> previous_version Keyword The version this action was applied to.  Optional <code>None</code> new_value Keyword The value the key is changing to.  Optional <code>None</code> type Enum The operation performed on the value.Values:<code>\"appended\", \"removed\", \"set\"</code>  Optional <code>None</code> previous_value Keyword The value the key is changing from.  Optional <code>None</code> user Keyword User ID who created the log event.  Yes <code>None</code>"},{"location":"odm/class/machine/","title":"Machine","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/machine/#machine","title":"Machine","text":"<p>Machine information.</p> Field Type Description Required Default type Keyword Machine type of the host machine.  Optional <code>None</code>"},{"location":"odm/class/nat/","title":"Nat","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/nat/#nat","title":"Nat","text":"<p>Translated NAT sessions (e.g. internal client to internet).</p> Field Type Description Required Default ip IP Translated IP of source based NAT sessions.  Optional <code>None</code> port Integer Translated port of source based NAT sessions.  Optional <code>None</code>"},{"location":"odm/class/organization/","title":"Organization","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/organization/#organization","title":"Organization","text":"<p>The organization fields enrich data with information about the company or entity the data is associated with.</p> Field Type Description Required Default id Keyword Unique identifier for the organization.  Optional <code>None</code> name Keyword Organization name.  Yes <code>None</code>"},{"location":"odm/class/os/","title":"Os","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/os/#os","title":"OS","text":"<p>The OS fields contain information about the operating system.</p> Field Type Description Required Default family Keyword OS family (such as redhat, debian, freebsd, windows).  Optional <code>None</code> full Keyword Operating system name, including the version or code name.  Optional <code>None</code> kernel Keyword Operating system kernel version as a raw string.  Optional <code>None</code> name Keyword Operating system name, without the version.  Optional <code>None</code> platform Keyword Operating system platform (such centos, ubuntu, windows).  Optional <code>None</code> type Keyword Use the os.type field to categorize the operating system into one of the broad commercial families.  Optional <code>None</code> version Keyword Operating system version as a raw string.  Optional <code>None</code>"},{"location":"odm/class/parentemail/","title":"Parentemail","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/parentemail/#parentemail","title":"ParentEmail","text":"<p>Metadata about the parent email.</p> Field Type Description Required Default bcc Address The email address of BCC recipient.  Optional <code>None</code> cc Address The email address of CC recipient.  Optional <code>None</code> from Address The email address of the sender, typically from the RFC 5322 From: header field.  Optional <code>None</code> message_id Keyword Identifier from the RFC 5322 Message-ID: email header that refers to a particular email message.  Optional <code>None</code> origination_timestamp Date The date and time the email message was composed.  Optional <code>None</code> subject Keyword A brief summary of the topic of the message.  Optional <code>None</code> to Address The email address of recipient.  Optional <code>None</code> source IP The ip the email originated from.  Optional <code>None</code> destination IP The ip the email was sent to.  Optional <code>None</code>"},{"location":"odm/class/parentprocess/","title":"Parentprocess","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/parentprocess/#parentprocess","title":"ParentProcess","text":"<p>These fields contain information about the parent process.</p> Field Type Description Required Default args List [Keyword] Array of process arguments, starting with the absolute path to the executable.  Optional <code>None</code> args_count Integer Length of the process.args array.  Optional <code>None</code> command_line Keyword Full command line that started the process, including the absolute path to the executable, and all arguments.  Optional <code>None</code> end Date None  Yes <code>None</code> entity_id Keyword Unique identifier for the process.  Optional <code>None</code> env_vars Mapping [Keyword] Environment variables (env_vars) set at the time of the event. May be filtered to protect sensitive information.  Optional <code>None</code> executable Keyword Absolute path to the process executable.  Optional <code>None</code> exit_code Integer The exit code of the process, if this is a termination event.  Optional <code>None</code> interactive Boolean Whether the process is connected to an interactive shell.  Optional <code>None</code> name Keyword Process name.  Optional <code>None</code> pid Integer Process id.  Optional <code>None</code> same_as_process Boolean This boolean is used to identify if a leader process is the same as the top level process.  Optional <code>None</code> start Date The time the process started.  Optional <code>None</code> user ShortUser The effective user (euid).  Optional <code>None</code>"},{"location":"odm/class/pe/","title":"Pe","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/pe/#pe","title":"PE","text":"<p>These fields contain Windows Portable Executable (PE) metadata.</p> Field Type Description Required Default architecture Keyword CPU architecture target for the file.  Optional <code>None</code> company Keyword Internal company name of the file, provided at compile-time.  Optional <code>None</code> description Keyword Internal description of the file, provided at compile-time.  Optional <code>None</code> file_version Keyword Internal version of the file, provided at compile-time.  Optional <code>None</code> imphash Keyword A hash of the imports in a PE file.  Optional <code>None</code> original_file_name Keyword Internal name of the file, provided at compile-time.  Optional <code>None</code> pehash Keyword A hash of the PE header and data from one or more PE sections.  Optional <code>None</code> product Keyword Internal product name of the file, provided at compile-time.  Optional <code>None</code>"},{"location":"odm/class/previousprocess/","title":"Previousprocess","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/previousprocess/#previousprocess","title":"PreviousProcess","text":"<p>These fields contain information about a previous process.</p> Field Type Description Required Default args List [Keyword] Array of process arguments, starting with the absolute path to the executable.  Optional <code>None</code> args_count Integer Length of the process.args array.  Optional <code>None</code> executable Keyword Absolute path to the process executable.  Optional <code>None</code>"},{"location":"odm/class/process/","title":"Process","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/process/#process","title":"Process","text":"<p>These fields contain information about a process.</p> Field Type Description Required Default args List [Keyword] Array of process arguments, starting with the absolute path to the executable.  Optional <code>None</code> args_count Integer Length of the process.args array.  Optional <code>None</code> command_line Keyword Full command line that started the process, including the absolute path to the executable, and all arguments.  Optional <code>None</code> end Date None  Optional <code>None</code> entity_id Keyword Unique identifier for the process.  Optional <code>None</code> env_vars Mapping [Keyword] Environment variables (env_vars) set at the time of the event. May be filtered to protect sensitive information.  Optional <code>None</code> executable Keyword Absolute path to the process executable.  Optional <code>None</code> exit_code Integer The exit code of the process, if this is a termination event.  Optional <code>None</code> interactive Boolean Whether the process is connected to an interactive shell.  Optional <code>None</code> name Keyword Process name.  Optional <code>None</code> parent List [ParentProcess] Information about the parent process.  Optional <code>None</code> pid Integer Process id.  Optional <code>None</code> same_as_process Boolean This boolean is used to identify if a leader process is the same as the top level process.  Optional <code>None</code> start Date The time the process started.  Optional <code>None</code> title Keyword Process title.  Optional <code>None</code> uptime Integer Seconds the process has been up.  Optional <code>None</code> user ShortUser The effective user (euid).  Optional <code>None</code> working_directory Keyword The working directory of the process.  Optional <code>None</code>"},{"location":"odm/class/project/","title":"Project","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/project/#project","title":"Project","text":"<p>Project information.</p> Field Type Description Required Default id Keyword The cloud project identifier.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code> name Keyword The cloud project name.  Optional  Deprecated - Instead of using this more general field, use a platform-specific field. For more information, see Disambiguated Cloud Ontology <code>None</code>"},{"location":"odm/class/registry/","title":"Registry","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/registry/#registry","title":"Registry","text":"<p>Fields related to Windows Registry operations.</p> Field Type Description Required Default data RegistryData Fields related to data written to Windows Registry.  Optional <code>None</code> hive Keyword Abbreviated name for the hive.  Optional <code>None</code> key Keyword Hive-relative path of keys.  Optional <code>None</code> path Keyword Full path, including hive, key and value.  Optional <code>None</code> value Keyword Name of the value written.  Optional <code>None</code>"},{"location":"odm/class/registrydata/","title":"Registrydata","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/registrydata/#registrydata","title":"RegistryData","text":"<p>Fields related to data written to Windows Registry.</p> Field Type Description Required Default bytes Keyword Original bytes written with base64 encoding.  Optional <code>None</code> strings List [Keyword] Content when writing string types.  Optional <code>None</code> type Keyword Standard registry type for encoding contents.  Optional <code>None</code>"},{"location":"odm/class/related/","title":"Related","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/related/#related","title":"Related","text":"<p>This field set is meant to facilitate pivoting around a piece of data.</p> Field Type Description Required Default hash List [Keyword] All the hashes seen on your event. Populating this field, then using it to search for hashes can help in situations where you're unsure what the hash algorithm is (and therefore which key name to search).  Yes <code>[]</code> hosts List [Keyword] All hostnames or other host identifiers seen on your event. Example identifiers include FQDNs, domain names, workstation names, or aliases.  Yes <code>[]</code> ip List [IP] All of the IPs seen on your event.  Yes <code>[]</code> user List [Keyword] All the user names or other user identifiers seen on the event.  Yes <code>[]</code> id Keyword The id related to the event.  Optional <code>None</code> uri List [URI] All of the URIs related to the event.  Optional <code>None</code> signature List [Keyword] All the signatures/rules that were triggered by the event.  Optional <code>None</code>"},{"location":"odm/class/request/","title":"Request","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/request/#request","title":"Request","text":"<p>These fields can represent errors of any kind.</p> Field Type Description Required Default body Body Defines the body of a request  Optional <code>None</code> bytes Integer Total size in bytes of the request (body and headers).  Optional <code>None</code> id Keyword A unique identifier for each HTTP request to correlate logs between clients and servers in transactions.  Optional <code>None</code> method Keyword HTTP request method.  Optional <code>None</code> mime_type Keyword Mime type of the body of the request.  Optional <code>None</code> referrer Keyword Referrer for this HTTP request.  Optional <code>None</code>"},{"location":"odm/class/response/","title":"Response","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/response/#response","title":"Response","text":"<p>These fields can represent errors of any kind.</p> Field Type Description Required Default body Body Defines the body of a response  Optional <code>None</code> bytes Integer Total size in bytes of the request (body and headers).  Optional <code>None</code> mime_type Keyword Mime type of the body of the request.  Optional <code>None</code> status_code Integer HTTP response status code.  Optional <code>None</code>"},{"location":"odm/class/rule/","title":"Rule","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/rule/#rule","title":"Rule","text":"<p>Rule fields are used to capture the specifics of any observer or agent rules that generate alerts or other notable events.</p> Field Type Description Required Default author Keyword Name, organization, or pseudonym of the author or authors who created the rule used to generate this event.  Optional <code>None</code> category Keyword A categorization value keyword used by the entity using the rule for detection of this event.  Optional <code>None</code> description Keyword The description of the rule generating the event.  Optional <code>None</code> id Keyword A rule ID that is unique within the scope of an agent, observer, or other entity using the rule for detection of this event.  Optional <code>None</code> license Keyword Name of the license under which the rule used to generate this event is made available.  Optional <code>None</code> name Keyword The name of the rule or signature generating the event.  Optional <code>None</code> reference Keyword Reference URL to additional information about the rule used to generate this event.  Optional <code>None</code> ruleset Keyword Name of the ruleset, policy, group, or parent category in which the rule used to generate this event is a member.  Optional <code>None</code> uuid Keyword A rule ID that is unique within the scope of a set or group of agents, observers, or other entities using the rule for detection of this event.  Optional <code>None</code> version Keyword The version / revision of the rule being used for analysis.  Optional <code>None</code>"},{"location":"odm/class/section/","title":"Section","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/section/#section","title":"Section","text":"<p>Definition of an ELF file section.</p> Field Type Description Required Default chi2 Integer Chi-square probability distribution of the section.  Optional <code>None</code> entropy Integer Shannon entropy calculation from the section.  Optional <code>None</code> flags Keyword ELF Section List flags.  Optional <code>None</code> name Keyword ELF Section List name.  Optional <code>None</code> physical_offset Keyword ELF Section List offset.  Optional <code>None</code> physical_size Integer ELF Section List physical size.  Optional <code>None</code> type Keyword ELF Section List type.  Optional <code>None</code> virtual_address Integer ELF Section List virtual address.  Optional <code>None</code> virtual_size Integer ELF Section List virtual size.  Optional <code>None</code>"},{"location":"odm/class/segment/","title":"Segment","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/segment/#segment","title":"Segment","text":"<p>Definition of an ELF file segment.</p> Field Type Description Required Default sections Keyword ELF object segment sections.  Optional <code>None</code> type Keyword ELF object segment type.  Optional <code>None</code>"},{"location":"odm/class/server/","title":"Server","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/server/#server","title":"Server","text":"<p>A Server is defined as the responder in a network connection for events regarding sessions, connections, or bidirectional flow records.</p> Field Type Description Required Default ip IP IP address of the server (IPv4 or IPv6).  Optional <code>None</code> address Keyword Some event server addresses are defined ambiguously. The event will sometimes list an IP, a domain or a unix socket. You should always store the raw address in the .address field.  Optional <code>None</code> domain Keyword The domain name of the server system.  Optional <code>None</code>"},{"location":"odm/class/service/","title":"Service","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/service/#service","title":"Service","text":"<p>Service information.</p> Field Type Description Required Default name Keyword The cloud service name is intended to distinguish services running on different platforms within a provider, eg AWS EC2 vs Lambda, GCP GCE vs App Engine, Azure VM vs App Server.  Optional <code>None</code>"},{"location":"odm/class/sharepoint/","title":"Sharepoint","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/sharepoint/#sharepoint","title":"Sharepoint","text":"<p>None</p> Field Type Description Required Default created SharepointData Information about how the item was created.  Optional <code>None</code> modified SharepointData Information about how the item was modified.  Optional <code>None</code>"},{"location":"odm/class/sharepointdata/","title":"Sharepointdata","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/sharepointdata/#sharepointdata","title":"SharepointData","text":"<p>None</p> Field Type Description Required Default application Keyword The associated application.  Optional <code>None</code> user Keyword The associated application.  Optional <code>None</code>"},{"location":"odm/class/sharepointuser/","title":"Sharepointuser","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/sharepointuser/#sharepointuser","title":"SharepointUser","text":"<p>None</p> Field Type Description Required Default email Email The email of the sharepoint user associated with this item.  Optional <code>None</code> full_name Keyword The full name of the sharepoint user associated with this item.  Optional <code>None</code> id Keyword The id of the sharepoint user associated with this item.  Optional <code>None</code>"},{"location":"odm/class/shortgroup/","title":"Shortgroup","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/shortgroup/#shortgroup","title":"ShortGroup","text":"<p>Shorter representation of a group.</p> Field Type Description Required Default id Keyword Unique identifier for the group on the system/platform.  Optional <code>None</code> name Keyword Name of the group.  Optional <code>None</code>"},{"location":"odm/class/shortuser/","title":"Shortuser","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/shortuser/#shortuser","title":"ShortUser","text":"<p>Shorter representation of a user.</p> Field Type Description Required Default id Keyword Unique identifier of the user.  Optional <code>None</code> name Keyword Short name or login of the user.  Optional <code>None</code>"},{"location":"odm/class/software/","title":"Software","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/software/#software","title":"Software","text":"<p>Information about the software used by this threat.</p> Field Type Description Required Default alias List [Keyword] The alias(es) of the software for a set of related intrusion activity that are tracked by a common name in the security community.  Optional <code>None</code> id Keyword The id of the software used by this threat to conduct behavior commonly modeled using MITRE ATT&amp;CK\u00ae.  Optional <code>None</code> name Keyword The name of the software used by this threat to conduct behavior commonly modeled using MITRE ATT&amp;CK\u00ae.  Optional <code>None</code> platform List [Keyword] The platforms of the software used by this threat to conduct behavior commonly modeled using MITRE ATT&amp;CK\u00ae.  Optional <code>None</code> reference Keyword The reference URL of the software used by this threat to conduct behavior commonly modeled using MITRE ATT&amp;CK\u00ae.  Optional <code>None</code> type Keyword The type of software used by this threat to conduct behavior commonly modeled using MITRE ATT&amp;CK\u00ae.  Optional <code>None</code>"},{"location":"odm/class/subtechnique/","title":"Subtechnique","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/subtechnique/#subtechnique","title":"SubTechnique","text":"<p>Information about the subtechnique used by this threat.</p> Field Type Description Required Default id Keyword The id of subtechnique used by this threat.  Optional <code>None</code> name Keyword Name of the type of subtechnique used by this threat.  Optional <code>None</code> reference Keyword The reference url of subtechnique used by this threat.  Optional <code>None</code>"},{"location":"odm/class/tactic/","title":"Tactic","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/tactic/#tactic","title":"Tactic","text":"<p>Information about the tactic used by this threat.</p> Field Type Description Required Default id Keyword The id of tactic used by this threat.  Optional <code>None</code> name Keyword Name of the type of tactic used by this threat.  Optional <code>None</code> reference Keyword The reference url of tactic used by this threat.  Optional <code>None</code>"},{"location":"odm/class/technique/","title":"Technique","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/technique/#technique","title":"Technique","text":"<p>Information about the technique used by this threat.</p> Field Type Description Required Default id Keyword The id of technique  used by this threat.  Optional <code>None</code> name Keyword Name of the type of technique used by this threat.  Optional <code>None</code> reference Keyword The reference url of technique used by this threat.  Optional <code>None</code> subtechnique SubTechnique Information about the subtechnique used by this threat.  Optional <code>None</code>"},{"location":"odm/class/thread/","title":"Thread","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/thread/#thread","title":"Thread","text":"<p>Thread Information.</p> Field Type Description Required Default id Integer Thread ID.  Optional <code>None</code> name Keyword Thread name.  Optional <code>None</code>"},{"location":"odm/class/threat/","title":"Threat","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/threat/#threat","title":"Threat","text":"<p>Fields to classify events and alerts according to a threat taxonomy such as the MITRE ATT&amp;CK\u00ae framework.</p> Field Type Description Required Default feed Feed Threat feed information.  Optional <code>None</code> framework Keyword Name of the threat framework used to further categorize and classify the tactic and technique of the reported threat.  Optional <code>None</code> group Group Information about the group related to this threat.  Optional <code>None</code> indicator Indicator Object containing associated indicators enriching the event.  Optional <code>None</code> software Software Information about the software used by this threat.  Optional <code>None</code> tactic Tactic Information about the tactic used by this threat.  Optional <code>None</code> technique Tactic Information about the technique used by this threat.  Optional <code>None</code>"},{"location":"odm/class/tls/","title":"Tls","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/tls/#tls","title":"TLS","text":"<p>A Server is defined as the responder in a network connection for events regarding sessions, connections, or bidirectional flow records.</p> Field Type Description Required Default version Keyword Numeric part of the version parsed from the original string.  Optional <code>None</code> version_protocol Keyword Normalized lowercase protocol name parsed from original string.  Optional <code>None</code> client Client None  Optional <code>None</code> server Server None  Optional <code>None</code>"},{"location":"odm/class/trigger/","title":"Trigger","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/trigger/#trigger","title":"Trigger","text":"<p>Details about the function trigger.</p> Field Type Description Required Default request_id Keyword The ID of the trigger request , message, event, etc.  Optional <code>None</code> type Enum The trigger for the function execution.Values:<code>\"datasource\", \"http\", \"other\", \"pubsub\", \"timer\"</code>  Optional <code>None</code>"},{"location":"odm/class/tty/","title":"Tty","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/tty/#tty","title":"TTY","text":"<p>Information about the controlling TTY device.</p> Field Type Description Required Default char_device CharDevice Information about the char device.  Optional <code>None</code>"},{"location":"odm/class/url/","title":"Url","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/url/#url","title":"URL","text":"<p>URL fields provide support for complete or partial URLs, and supports the breaking down into scheme, domain, path, and so on.</p> Field Type Description Required Default domain Domain Domain of the url, such as \"www.elastic.co\".  Optional <code>None</code> extension Keyword The field contains the file extension from the original request url, excluding the leading dot.  Optional <code>None</code> fragment Keyword Portion of the url after the #, such as \"top\".  Optional <code>None</code> full Keyword If full URLs are important to your use case, they should be stored in url.full, whether this field is reconstructed or present in the event source.  Optional <code>None</code> original Keyword Unmodified original url as seen in the event source.  Optional <code>None</code> password Keyword Password of the request.  Optional <code>None</code> path Keyword Path of the request, such as \"/search\".  Optional <code>None</code> port Integer Port of the request, such as 443.  Optional <code>None</code> query Keyword The query field describes the query string of the request, such as \"q=elasticsearch\".  Optional <code>None</code> registered_domain Keyword The highest registered url domain, stripped of the subdomain.  Optional <code>None</code> scheme Keyword Scheme of the request, such as \"https\".  Optional <code>None</code> subdomain Keyword The subdomain portion of a fully qualified domain name includes all of the names except the host name under the registered_domain.  Optional <code>None</code> top_level_domain Keyword The effective top level domain (eTLD), also known as the domain suffix, is the last part of the domain name.  Optional <code>None</code> username Keyword Username of the request.  Optional <code>None</code>"},{"location":"odm/class/user/","title":"User","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/user/#user","title":"User","text":"<p>The user fields describe information about the user that is relevant to the event.</p> Field Type Description Required Default domain Keyword Name of the directory the user is a member of.  Optional <code>None</code> email Email User email address.  Optional <code>None</code> full_name Keyword User\u2019s full name, if available.  Optional <code>None</code> group Group User\u2019s group relevant to the event.  Optional <code>None</code> hash Keyword Unique user hash to correlate information for a user in anonymized form.  Optional <code>None</code> id Keyword Unique identifier of the user.  Optional <code>None</code> name Keyword Short name or login of the user.  Optional <code>None</code> roles List [Keyword] Array of user roles at the time of the event.  Optional <code>[]</code>"},{"location":"odm/class/useragent/","title":"Useragent","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/useragent/#useragent","title":"UserAgent","text":"<p>The user_agent fields normally come from a browser request.</p> Field Type Description Required Default device Device Information about the device.  Optional <code>None</code> name Keyword Name of the user agent.  Optional <code>None</code> original Keyword Unparsed user_agent string.  Optional <code>None</code> os OS OS fields contain information about the operating system.  Optional <code>None</code> version Keyword Version of the user agent.  Optional <code>None</code>"},{"location":"odm/class/usernested/","title":"Usernested","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/usernested/#usernested","title":"UserNested","text":"<p>The user fields describe information about the user that is relevant to the event.</p> Field Type Description Required Default domain Keyword Name of the directory the user is a member of.  Optional <code>None</code> email Email User email address.  Optional <code>None</code> full_name Keyword User\u2019s full name, if available.  Optional <code>None</code> hash Keyword Unique user hash to correlate information for a user in anonymized form.  Optional <code>None</code> id Keyword Unique identifier of the user.  Optional <code>None</code> name Keyword Short name or login of the user.  Optional <code>None</code> roles List [Keyword] Array of user roles at the time of the event.  Optional <code>[]</code>"},{"location":"odm/class/votes/","title":"Votes","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/votes/#votes","title":"Votes","text":"<p>Votes for the hit</p> Field Type Description Required Default benign List [Keyword] List of users who voted benign.  Yes <code>[]</code> obscure List [Keyword] List of users who voted obscure.  Yes <code>[]</code> malicious List [Keyword] List of users who voted malicious.  Yes <code>[]</code>"},{"location":"odm/class/vulnerability/","title":"Vulnerability","text":"Auto-Generated Documentation <p>This set of documentation is automatically generated from source, and will help ensure any change to functionality will always be documented and available on release.</p>"},{"location":"odm/class/vulnerability/#vulnerability","title":"Vulnerability","text":"<p>The user_agent fields normally come from a browser request.</p> Field Type Description Required Default category List [Keyword] The type of system or architecture that the vulnerability affects. These may be platform-specific (for example, Debian or SUSE) or general (for example, Database or Firewall).  Optional <code>None</code> classification Keyword The classification of the vulnerability scoring system. For example (https://www.first.org/cvss/)  Optional <code>None</code> description Keyword The description of the vulnerability that provides additional context of the vulnerability.  Optional <code>None</code> enumeration Keyword The type of identifier used for this vulnerability.  Optional <code>None</code> id Keyword The identification (ID) is the number portion of a vulnerability entry. It includes a unique identification number for the vulnerability.  Optional <code>None</code> reference Keyword A resource that provides additional information, context, and mitigations for the identified vulnerability.  Optional <code>None</code> report_id Keyword The report or scan identification number.  Optional <code>None</code>"},{"location":"overview/architecture/","title":"System Architecture","text":"<p>Here's the system architecture</p>"},{"location":"overview/detection_engineers/","title":"Detection Engineers","text":"<p>You have just written an analytic that detects some suspicious activity and you would like your Security Operations Center (SOC) to benefit from it. In Howler, an event of interest is called a hit. The term alert is reserved for hits that require triage.</p> <p>To create a new hit, produce a JSON object in which you have normalized the event data to Elastic Common Schema. We do this so that triage analysts have a single schema to learn regardless of the source of alerts - this will make their job much easier.</p> <p>Next, you need to populate some fields specific to Howler:</p> <ul> <li><code>howler.detection</code> - A short, unique identifier for the specific detection.</li> <li><code>howler.analytic</code> - The actual product doing detection. Some analytics will run many distinct detections.</li> <li><code>howler.outline.threat</code> - The identifier that best represents the attacker. This could be an IP, email address, etc...</li> <li><code>howler.outline.target</code> - The identifier that best represents the victim. Again, an IP, domain, email address, etc...</li> <li><code>howler.outline.indicators</code> - A free-form list of indicators of compromise (IoC). These are typically IPs, domains and hashes.</li> <li><code>howler.outline.summary</code>- An executive summary explaining the activity that is being detected. Describe the event with the assumption that the detection is correct.</li> <li><code>howler.data</code> - A list of dictionaries of the raw event before normalization. This makes it easier for analysts if they need to take their investigation outside of Howler.</li> </ul> <p>Howler uses escalation levels (<code>howler.escalation</code>) to categorise hits:</p> <ul> <li><code>miss</code> - The event is assessed to not be related to detection (false-positive).</li> <li><code>hit</code> - (default) The event might not be very reliable without additional context.</li> <li><code>alert</code> - The event should be assessed by a triage analyst.</li> <li><code>evidence</code> - The event was assessed as related to the detection (true-positive).</li> </ul> <p>You may promote some hits to alert immediately at creation time if the expectation is that all hits will be worth triaging.</p> <p>Once you have completed the JSON object, use the Howler client to create a new hit. That hit will be immediately available to triage analysts from the Howler UI.</p>"},{"location":"overview/detection_engineers/#bundles","title":"Bundles","text":"<p>A bundle is a logical grouping of hits that should be assessed together. For example, if a series of multiple hits happen on the same host within a short window of time, a triage analyst should perform a single investigation that takes them all into account. The Howler UI provides a workflow for intuitively working with these bundles.</p> <p>Bundles are implemented as hits that have the howler.is_bundle field set to true, and howler.hits contains a list of howler.id values. This means that analytics can be created to look for related hits and bundle them.</p>"},{"location":"overview/detection_engineers/#analytics-page","title":"Analytics Page","text":"<p>The Analytics section of the Howler UI provides a support page for analytics and individual detections. It contains useful information for both the author of a analytic or detection as well as the triage analysts who are investigating the hits.</p>"},{"location":"overview/detection_engineers/#overview","title":"Overview","text":"<p>Here, you are encouraged to provide documentation in Markdown. This should provide more details about how the analytic or detection works, what it's looking for and how to validate the hits.</p> <p>Metrics are automatically generated to give insights on the performance. A very high false-positive rate might be a sign that detection needs improvement. On the other hand, a high true-positive rate might warrant that hits be automatically promoted to alerts.</p>"},{"location":"overview/detection_engineers/#comments","title":"Comments","text":"<p>In this tab, users can leave feedback about an analytic or detection. Consider this your end-user's line of communication with you.</p>"},{"location":"overview/detection_engineers/#hit-comments","title":"Hit Comments","text":"<p>From here, you can review all of the comments left on specific hits to better understand what triage analysts are signaling to each other.</p>"},{"location":"overview/detection_engineers/#notebooks","title":"Notebooks","text":"<p>If your triage analysts are frequently needing to investigate alerts outside of Howler, you can link to a Jupyter Notebook. That means a button will appear in the Howler UI. When a user clicks the button, they will be taken to JupyterHub with the specified Notebook open and the specific hit loaded, allowing the queries to be pre-populated with relevant values.</p>"},{"location":"overview/triage_analysts/","title":"Triage Analysts","text":"<p>Howler is designed to consolidate alerts from all sources, and differentiates those that require triage from those that might not. Detection engineers are expected to normalize the alerts, so that they can all be looked up and compared with a common schema: Elastic Common Schema (ECS). By putting all of the alerts in one place under one schema, it's much easier to find correlating events that warrant scrutiny from a triage analyst. For example, an analyst can easily find all alerts related to a given source IP with a single filter criteria regardless of the schema of the original telemetry.</p> <p>Howler demands that detection engineers explicitly outline the the who, what, when, where and why for each alert they produce. This means that triage analysts aren't presented with cryptic alerts that provide no clue how to validate them. For example, the threat and target fields make it clear who is attacking whom.</p> <p>The next big improvement offered by Howler is customization. Each type of event can have a custom presentation, so we don't flood the triage analyst's screen with unimportant information or leave important details tucked away behind multiple clicks. For example, with some alerts, the HTTP referrer field might be critical, but in others it may be meaningless.</p> <p>Howler supports automation through matching alerts to filters. If a new alert matches the prepared filter, the specified actions will automatically be carried out. These include prioritization, tagging and assessments to name a few. If an analyst keeps seeing alerts for the same sys-admin script that they know is legitimate activity, they might add an action to apply a \"sys-admin\" tag to alerts that match a carefully tailored filter. Then, they might decide to automatically assess any alert with a \"sys-admin\" tag as \"legitimate\" to avoid wasting effort triaging them.</p> <p>All of these capabilities combine to provide triage teams with a comprehensive suite of tools that enable them to process more alerts in greater detail.</p>"},{"location":"overview/triage_analysts/#hits","title":"Hits","text":"<p>A lot of detected events are only weak-indicators and aren't worth the effort to triage individually, so we refer to them as hits. Howler uses the term alert to describe the subset that should be triaged. Any that are assessed as inaccurate (false-positive) can be demoted to miss while those that are assess as accurate are promoted to evidence.</p> <p>Their continuum of escalation is as such: miss -&gt; hit -&gt; alert -&gt; evidence</p> <p>In most cases, triage analysts are concerned with alerts, which they promote to evidence or demote to a miss. To review alerts, a triage analyst navigates to the Alerts page from the left side-bar. There, they are presented with a filter box. The syntax for the filter is Lucene. The schema of the data is Elastic Common Schema (ECS).</p> <p>To filter for a certain escalation, filter on <code>howler.escalation</code>. For example, to look at alerts, write: <code>howler.escalation: alert</code>.</p>"},{"location":"overview/triage_analysts/#hit-cards","title":"Hit Cards","text":"<p>The Howler UI displays an abbreviated version of each hit as a card. This is designed in a way to reduce the amount of effort required for a triage analyst to understand the nature of the hit and its context.</p>"},{"location":"overview/triage_analysts/#banner","title":"Banner","text":"<p>The banner at the top of each hit provides standardized context addressing the who, what, when, where and why.</p>"},{"location":"overview/triage_analysts/#title","title":"Title","text":"<p>The title on the card is the analytic and detection that created the hit. The software product that created the hit is called the analytic. The logic finding and selecting specific events is called the detection. One analytic can have many detections. These two concepts are expressed in the <code>howler.analytic</code> and <code>howler.detection</code> fields.</p> <p>You can filter for hits belonging to a specific detection. For example, to look at hits produced by a detection called \"User Creds Beacon\", write: <code>howler.detection: \"User Creds Beacon\"</code>.</p>"},{"location":"overview/triage_analysts/#icon","title":"Icon","text":"<p>The name represents the affected organization, department or team. It is stored in <code>organization.name</code>. The left of the banner is coloured based on the event collection mechanism. This is determined by the <code>event.provider</code> field. The picture represents the Mitre ATT&amp;CK Framework specified in <code>threat.tactic.id</code> or <code>threat.technique.id</code>.</p>"},{"location":"overview/triage_analysts/#status","title":"Status","text":"<p>To the right of the banner is the status. This has a timestamp, the user the hit is assigned to and the escalation for the hit. Additionally, if other users are currently reviewing this hit, their icon will appear in this section.</p>"},{"location":"overview/triage_analysts/#context","title":"Context","text":"<p>The lower part of the banner provides the key aspects of context needed to understand the hit.</p>"},{"location":"overview/triage_analysts/#threat","title":"Threat","text":"<p>The identifier that best represents the attacker. This could be an IP, email address, etc... Use this to find other hits that appear to come from the same attacker. (<code>howler.outline.threat</code>)</p>"},{"location":"overview/triage_analysts/#target","title":"Target","text":"<p>The identifier that best represents the attacker. This could be an IP, email address, etc... User this to find other hits that appear to affect the same victim. (<code>howler.outline.target</code>)</p>"},{"location":"overview/triage_analysts/#indicators","title":"Indicators","text":"<p>A free-form list of indicators of compromise (IoC). These are typically IPs, domains and hashes. Use this to find related attacks based on their infrastructure and tactics. (<code>howler.outline.indicators</code>)</p>"},{"location":"overview/triage_analysts/#summary","title":"Summary","text":"<p>An executive summary explaining the activity that is being detected. When assessing a hit, you are try to corroborate or refute this very statement. (<code>howler.outline.summary</code>)</p>"},{"location":"overview/triage_analysts/#details","title":"Details","text":"<p>This section can show additional metadata contained in an alert. The fields shown should be the ones that are most important for making an assessment of that particular detection.</p>"},{"location":"overview/triage_analysts/#templates","title":"Templates","text":"<p>Templates are the mechanism used to customize which fields are displayed in a hit card's details section. On the top right of the details section of a hit card is an icon specifying whether you are currently viewing a global or personal template. Clicking on this icon will allow you to modify the template.</p> <p>Here you can specify whether you are creating a template for all hits from a given analytic, or optionally, that it is only for hits from a specific detection.</p> <p>You can make it a personal filter that only affects the hit cards you're seeing. This will override any global filter. If you make your filter global, it will affect the template of any user who hasn't created a personal template.</p> <p>When designing a template, you can add or delete any field found in the hit's metadata. All those present will be displayed in the details of hits matching from the analytic or detection. Avoid adding fields that aren't necessary for an assessment as they will slow down the rate at which analysts can interpret the hit card.</p>"},{"location":"overview/triage_analysts/#dossier","title":"Dossier","text":"<p>Clicking on a hit card will open its dossier on the right side of the Howler UI. A series of tabs provide additional information about a given hit. At the top is the same banner found at the top of a hit card. If the detection engineer has provided integration with external tools, their button (image) will appear below the banner.</p>"},{"location":"overview/triage_analysts/#comments","title":"Comments","text":"<p>This section allows you to write comments for yourself or colleagues.</p>"},{"location":"overview/triage_analysts/#json","title":"JSON","text":"<p>This will show you a JSON representation of the hit's metadata, including all fields that the detection engineer mapped to ECS.</p>"},{"location":"overview/triage_analysts/#raw-data","title":"Raw Data","text":"<p>This is the raw event that was identified by the detection. This will be a list of events if multiple are involved. Use this if you need to continue your investigation outside of Howler. It will show the original field names before mapping to ECS, so that you're able to build the right queries.</p>"},{"location":"overview/triage_analysts/#worklog","title":"Worklog","text":"<p>All changes made to a given hit are logged here.</p>"},{"location":"overview/triage_analysts/#related-links","title":"Related Links","text":"<p>These are provided if they offer additional useful context that couldn't be integrated with Howler.</p>"},{"location":"overview/triage_analysts/#controls","title":"Controls","text":"<p>At the bottom of the dossier are a series of controls that allow analysts affect hits in various ways.</p>"},{"location":"overview/triage_analysts/#manage","title":"Manage","text":"<ul> <li>Promote: Go from hit to alert</li> <li>Demote: Go from alert to hit</li> <li>Assign To Me: Signal to others that you will assess this hit.</li> <li>Delegate: Signal to an individual or team that they should assess this hit.</li> <li>Release: Return this hit to unassigned.</li> <li>Pause: Signal that you are delaying your assessment.</li> <li>Resume: Signal you are once again working on your assessment.</li> </ul> <p>The options here change based on the current state of a hit, so you will only see a few choices at any given moment.</p>"},{"location":"overview/triage_analysts/#assess","title":"Assess","text":"<p>This is where you can indicate a final verdict for your investigation. (<code>howler.assessment</code>)</p> <ul> <li>Ambiguous: There wasn't enough information to make an assessment.</li> <li>Security: The event is authorized cyber-security activity like training exercises.</li> <li>Development: The hit is for development purposes and should be ignored.</li> <li>False-Positive: The event is not indicative of the circumstances the detection is looking for.</li> <li>Legitimate: The event is authorized activity.</li> <li>Trivial: The impact of the event is not significant enough to merit mitigation.</li> <li>Recon: The event represents reconnaissance, but put does not pose an imminent threat.</li> <li>Attempt: There event represents an attempted attack that doesn't appear to have succeeded.</li> <li>Compromise: The event represents a successful compromise that must be mitigated.</li> <li>Mitigated: The event represents a successful compromise for which mitigating action is underway.</li> </ul> <p>Rationale: Once you add an assessment, you're asked to provide a rationale as free-form text. This is a quick summary explaining to your colleagues, or your future-self, why you have confidence in that assessment. (<code>howler.rationale</code>)</p>"},{"location":"overview/triage_analysts/#vote","title":"Vote","text":"<p>In instances where an analyst doesn't have enough information to make a confident assessment, but they they have a \"gut feeling\" about the event, they can place a vote. It's up to the triage team to decide how they use the votes, but one suggestions could be that a consensus in votes can be used to make an assessment. (<code>howler.votes.bening/obscure/malicious</code>)</p>"},{"location":"overview/triage_analysts/#views","title":"Views","text":"<p>Writing filters can be time consuming. Triage analysts often need to use the same filters for their workflow. Howler streamlines this through views. After writing a filter, click the heart icon to the right of the filter and specify a name. Now that view can be accessed from the View Manager on the left side-bar. If you click on the star to the right of a filter here, it will appear under Saved Views in the left side-bar.</p>"},{"location":"overview/triage_analysts/#global-views","title":"Global Views","text":"<p>Members of a teams often rely on the same filters. By specifying a view as global during it's creation, other users will see this view in the Global Views page under the GLOBAL filter.</p>"},{"location":"overview/triage_analysts/#bundles","title":"Bundles","text":"<p>In instances where multiple events appear to be related to each-other, they can be packaged together as a bundle. This is a special type of hit that points to other hits. They can be identified by the <code>howler.is_bundle:true</code> filter. The related hits can be found in the <code>howler.hits</code> list which contains the <code>howler.id</code> value of each.</p> <p>When a triage analysts clicks on a bundle's card, the banner for the bundle is moved above the filter bar and the bundle hits' cards are displayed under the filter bar. Any filter provided will only apply to the hits associated with the bundle.</p> <p>Any controls used on the bundle will automatically be propagated to its related hits.</p> <p>A good example of hits you'd want to bundle would be a sequence of hits occurring on the same host within a short window of time. Individually, those hits might be far too unreliable to consider triaging them, but with the added context that several of them happening on the same host in a short time window, it would be reasonable to automatically promote the bundle to alert to ensure someone triages it. By bundling them, we ensure that not only does a triage analyst review the host, but knows of all other potentially related activity taking place.</p>"},{"location":"overview/triage_analysts/#bundle-summary","title":"Bundle Summary","text":"<p>Bundles have an additional tab in the bundle's dossier called Summary. If you click the Create Summary button, it will count the distinct values of each filed of the hits. Use this to get an idea of the overall situation.</p>"},{"location":"fr/ingestion/authentication/#authentification-de-howler","title":"Authentification de Howler","text":"<p>L'API de Howler prend en charge un certain nombre d'approches d'authentification lors de l'acc\u00e8s \u00e0 l'API. Ce document pr\u00e9sente les diff\u00e9rentes approches et explique comment utiliser chacune d'entre elles.</p>"},{"location":"fr/ingestion/authentication/#types-dauthentification","title":"Types d'authentification","text":"<p>Il existe quatre m\u00e9thodes d'authentification que l'on peut utiliser pour se connecter \u00e0 l'API howler:</p> <ol> <li>Nom d'utilisateur et mot de passe</li> <li>Nom d'utilisateur et cl\u00e9 API</li> <li>Nom d'utilisateur et cl\u00e9 d'application (apr\u00e8s connexion)</li> <li>Jeton d'acc\u00e8s OAuth</li> </ol> <p>Nous allons maintenant pr\u00e9senter les cas d'utilisation de chaque type d'authentification.</p>"},{"location":"fr/ingestion/authentication/#authentification-par-nom-dutilisateurmot-de-passe","title":"Authentification par nom d'utilisateur/mot de passe","text":"<p>L'authentification par nom d'utilisateur et mot de passe est la m\u00e9thode d'authentification la plus simple et la moins s\u00fbre. Il est peu probable qu'elle soit activ\u00e9e dans un environnement de production, elle permet aux utilisateurs de se connecter facilement \u00e0 l'API Howler et d'effectuer des modifications en tant qu'utilisateur donn\u00e9, sans avoir \u00e0 se soucier de cr\u00e9er des cl\u00e9s API ou d'utiliser un fournisseur OAuth comme Keycloak ou Azure. Les utilisateurs peuvent se connecter en utilisant l'authentification par nom d'utilisateur et mot de passe de l'une des deux mani\u00e8res suivantes :</p>"},{"location":"fr/ingestion/authentication/#appel-direct-au-point-de-terminaison-requis-mot-de-passe","title":"Appel direct au point de terminaison requis (mot de passe)","text":"<p>C'est de loin la m\u00e9thode la plus simple. Il suffit d'ajouter un en-t\u00eate d'autorisation de base \u00e0 la requ\u00eate HTTP que vous souhaitez effectuer, et tout est pris en charge. que vous voulez faire, et tout est pris en charge:</p> <pre><code>echo -n \"user:user\" | base64 -w0\n# -&gt; dXNlcjp1c2Vy\n</code></pre> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic dXNlcjp1c2Vy\n</code></pre>"},{"location":"fr/ingestion/authentication/#echange-contre-un-jeton-dapplication-mot-de-passe","title":"\u00c9change contre un jeton d'application (mot de passe)","text":"<p>Il s'agit d'une approche un peu plus complexe, mais qui pr\u00e9sente l'avantage de ne pas exposer le nom d'utilisateur et le mot de passe \u00e0 chaque demande. \u00e0 chaque requ\u00eate. Vous pouvez utiliser le point de terminaison <code>v1/auth/login</code> pour \u00e9changer votre nom d'utilisateur et votre mot de passe contre un jeton d'application. Le jeton fonctionne de la m\u00eame mani\u00e8re qu'un jeton d'acc\u00e8s OAuth - vous le fournissez \u00e0 chaque requ\u00eate ult\u00e9rieure, et il vous authentifie jusqu'\u00e0 ce que le jeton expire. jusqu'\u00e0 ce que le jeton expire.</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"user\": \"user\",\n  \"password\": \"user\"\n}\n</code></pre> <p>Le r\u00e9sultat sera quelque chose comme:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"app_token\": \"user:5791a142067745c3af51d6596da7da8f86357a9fa92ad78d1ce118ea7d89d34e\",\n    \"provider\": null,\n    \"refresh_token\": null\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Utilisation de ce jeton dans un autre appel d'API:</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer user:5791a142067745c3af51d6596da7da8f86357a9fa92ad78d1ce118ea7d89d34e\n</code></pre>"},{"location":"fr/ingestion/authentication/#authentification-par-nom-dutilisateurcle-api","title":"Authentification par nom d'utilisateur/cl\u00e9 API","text":"<p>L'authentification par nom d'utilisateur et cl\u00e9 API fonctionne en grande partie de la m\u00eame mani\u00e8re que l'authentification par nom d'utilisateur/mot de passe du point de vue du client. Du c\u00f4t\u00e9 du serveur, cependant, les cl\u00e9s API pr\u00e9sentent plusieurs avantages essentiels. Tout d'abord, elles peuvent \u00eatre facilement r\u00e9voqu\u00e9es par l'utilisateur. Deuxi\u00e8mement, leurs privil\u00e8ges peuvent \u00eatre limit\u00e9s, n'autorisant qu'un sous-ensemble de permissions.</p> <p>Il existe deux m\u00e9thodes d'authentification, refl\u00e9tant le nom d'utilisateur et le mot de passe:</p>"},{"location":"fr/ingestion/authentication/#appel-direct-au-point-de-terminaison-requis-cle-api","title":"Appel direct au point de terminaison requis (cl\u00e9 API)","text":"<p>Il suffit d'ajouter un en-t\u00eate d'autorisation de base contenant le nom d'utilisateur et la cl\u00e9 API \u00e0 la requ\u00eate HTTP que vous souhaitez effectuer, et tout est pris en charge:</p> <pre><code># note the format is &lt;username&gt;:&lt;apikeyname&gt;:&lt;secret&gt;\necho -n \"user:devkey:user\" | base64 -w0\n# -&gt; dXNlcjpkZXZrZXk6dXNlcg==\n</code></pre> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic dXNlcjpkZXZrZXk6dXNlcg==\n</code></pre>"},{"location":"fr/ingestion/authentication/#echange-contre-un-jeton-dapplication-cle-api","title":"\u00c9change contre un jeton d'application (cl\u00e9 API)","text":"<p>Vous pouvez \u00e9galement utiliser le point de terminaison <code>v1/auth/login</code> pour \u00e9changer votre nom d'utilisateur et votre cl\u00e9 API contre un jeton d'application. Le jeton fonctionne de la m\u00eame mani\u00e8re qu'un jeton d'acc\u00e8s OAuth - vous le fournissez \u00e0 chaque demande ult\u00e9rieure, et il vous authentifie jusqu'\u00e0 ce que le jeton expire.</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"user\": \"user\",\n  \"apikey\": \"devkey:user\"\n}\n</code></pre> <p>Le r\u00e9sultat sera quelque chose comme:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"app_token\": \"user:f220eb76ff8404abfece8c0c2f3368c7d89618c776bedcd3a506843dc4a952e4\",\n    \"provider\": null,\n    \"refresh_token\": null\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Utilisation de ce jeton dans un autre appel d'API:</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer user:f220eb76ff8404abfece8c0c2f3368c7d89618c776bedcd3a506843dc4a952e4\n</code></pre> <p>Notez que lorsque vous vous connectez \u00e0 l'aide d'une cl\u00e9 d'api, les autorisations de la cl\u00e9 d'api continuent de s'appliquer. Ainsi, si vous essayez d'acc\u00e9der \u00e0 \u00e0 un point d'acc\u00e8s qui requiert l'autorisation \"write\" avec une cl\u00e9 API qui n'a que l'autorisation \"read\", cela provoquera une erreur 403 Forbidden (Interdit).</p>"},{"location":"fr/ingestion/authentication/#authentification-par-jeton-dacces","title":"Authentification par jeton d'acc\u00e8s","text":"<p>En plus des m\u00e9thodes d'authentification fournies en interne par Howler, vous pouvez \u00e9galement vous authentifier avec un fournisseur OAuth externe comme Azure ou Keycloak. Pour ce faire, vous devez obtenir un jeton d'acc\u00e8s aupr\u00e8s de l'un de ces fournisseurs. Pour obtenir un jeton d'acc\u00e8s, il y a g\u00e9n\u00e9ralement deux flux - On-Behalf-Of, ou le flux de connexion de l'utilisateur (voir ici pour un r\u00e9capitulatif de cela). Dans le cas de Howler, le point de terminaison <code>v1/auth/login</code> est utilis\u00e9 pour les \u00e9tapes D &amp; E du flux de connexion de l'utilisateur, et il renvoie ce qui suit:</p> <pre><code>{\n    \"api_response\": {\n        \"app_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyIn0\",\n        \"provider\": \"keycloak\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNoIn0\"\n    }\n}\n</code></pre> <p>Dans ce cas, le <code>app_token</code> est le Web Token JSON que l'application utilise comme jeton d'acc\u00e8s. De la m\u00eame mani\u00e8re, le <code>refresh_token</code> est un autre JWT qui est utilis\u00e9 pour rafra\u00eechir le jeton d'acc\u00e8s si n\u00e9cessaire. Enfin, le champ <code>provider</code> (fournisseur) indique \u00e0 quel fournisseur correspond ce jeton d'acc\u00e8s.</p> <p>Une fois que vous avez ce jeton d'acc\u00e8s, vous pouvez simplement le transmettre dans l'en-t\u00eate Authorization :</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyIn0\n</code></pre> <p>Howler d\u00e9tectera automatiquement qu'il s'agit d'un JWT et le traitera comme tel. Si le jeton est valide, l'utilisateur sera authentifi\u00e9.</p> <p>Afin de rafra\u00eechir un jeton d'acc\u00e8s expir\u00e9, vous pouvez utiliser l'appel API suivant:</p> <pre><code>POST howler.example.com/api/v1/auth/login/\nContent-Type: application/json\n\n{\n  \"oauth_provider\": \"keycloak\",\n  \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNoIn0\"\n}\n</code></pre> <p>Et vous obtiendrez quelque chose comme ceci en retour:</p> <pre><code>{\n    \"api_response\": {\n        \"app_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1c2VyMiJ9\",\n        \"provider\": \"keycloak\",\n        \"refresh_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJyZWZyZXNodG9rZW4yIn0\"\n    }\n}\n</code></pre>"},{"location":"fr/ingestion/authentication/#impersonation","title":"Impersonation","text":"<p>Le dernier \u00e9l\u00e9ment important du flux d'authentification est la fonctionnalit\u00e9 d'usurpation d'identit\u00e9. Pour qu'un compte de service ou un autre utilisateur puisse se faire passer pour vous (c'est-\u00e0-dire cr\u00e9er des alertes en votre nom), Howler permet aux utilisateurs de fournir une deuxi\u00e8me cl\u00e9 API afin de s'authentifier en tant qu'autre utilisateur.</p> <p>Avant d'utiliser la cl\u00e9 API d'un autre utilisateur pour vous authentifier en tant que lui, il est important que la cl\u00e9 API que vous utilisez ait \u00e9t\u00e9 marqu\u00e9e comme valide pour l'usurpation d'identit\u00e9 - v\u00e9rifiez aupr\u00e8s de l'utilisateur qui l'a fournie. Si c'est le cas, vous pouvez l'utiliser en formulant votre requ\u00eate comme suit:</p> <pre><code># Your credentials\necho -n \"admin:devkey:admin\" | base64 -w0\n# -&gt; YWRtaW46ZGV2a2V5OmFkbWlu\n\n# Their credentials\necho -n \"user:impersonate_admin:user\" | base64 -w0\n# -&gt; dXNlcjppbXBlcnNvbmF0ZV9hZG1pbjp1c2Vy\n</code></pre> Note <p>Toute forme d'authentification peut \u00eatre utilis\u00e9e par l'usurpateur, mais les cl\u00e9s API valid\u00e9es sont la seule m\u00e9thode d'authentification autoris\u00e9e pour la personne dont vous usurpez l'identit\u00e9.</p> <pre><code>GET howler.example.com/api/v1/user/whoami\nAuthorization: Basic YWRtaW46ZGV2a2V5OmFkbWlu\nX-Impersonating: Basic dXNlcjppbXBlcnNvbmF0ZV9hZG1pbjp1c2Vy\n</code></pre> <p>Si la configuration est correcte, le r\u00e9sultat sera le suivant:</p> <pre><code>{\n  \"api_error_message\": \"\",\n  \"api_response\": {\n    \"avatar\": null,\n    \"classification\": \"TLP:W\",\n    \"email\": \"user@howler.example.com\",\n    \"groups\": [\n      \"USERS\"\n    ],\n    \"is_active\": true,\n    \"is_admin\": false,\n    \"name\": \"User\",\n    \"roles\": [\n      \"user\"\n    ],\n    \"username\": \"user\"\n  },\n  \"api_server_version\": \"0.0.0.dev0\",\n  \"api_status_code\": 200\n}\n</code></pre> <p>Notez que le serveur a renvoy\u00e9 cette requ\u00eate comme si vous \u00e9tiez <code>user</code>, PAS <code>admin</code>. Il est cependant clairement indiqu\u00e9 dans les logs que c'est vous qui faites la requ\u00eate:</p> <pre><code>22/12/05 14:15:02 INFO howler.api.security | Authenticating user for path /api/v1/user/whoami/\n22/12/05 14:15:03 WARNING howler.api.security | admin is impersonating user\n22/12/05 14:15:03 INFO howler.api.security | Logged in as user from 127.0.0.1\n22/12/05 14:15:03 INFO howler.api | GET /api/v1/user/whoami/ - 200\n</code></pre>"},{"location":"fr/ingestion/bundles/#les-groupes-des-hits-howler","title":"Les groupes des hits Howler","text":"<p>Les groupes des hits peuvent \u00eatre utilis\u00e9s pour regrouper facilement un grand nombre d'alertes similaires, ce qui permet aux analystes de les traiter comme un seul incident. Prenons l'exemple d'un ordinateur qui effectue \u00e0 plusieurs reprises un appel r\u00e9seau vers <code>baddomain.ru</code> - bien qu'une alerte puisse \u00eatre g\u00e9n\u00e9r\u00e9e pour chaque cas o\u00f9 cet ordinateur acc\u00e8de \u00e0 ce domaine, il est logique que les analystes traitent toutes ces alertes comme un seul et m\u00eame cas.</p>"},{"location":"fr/ingestion/bundles/#creation-de-groupes-via-le-client-howler","title":"Cr\u00e9ation de groupes via le client Howler","text":"<p>Il y a plusieurs fa\u00e7ons de cr\u00e9er un groupe via le client Howler:</p> <pre><code>from howler_client import get_client\n\nhowler = get_client(\"https://howler.example.com\")\n\n\"\"\"Cr\u00e9ation simultan\u00e9e d'un groupe howler et de hits\"\"\"\nhowler.bundle.create(\n    # Le premier argument est le hit de l'offre group\u00e9e\n    {\n        \"howler.analytic\": \"example-test\",\n        \"howler.score\": 0\n    },\n    # Le deuxi\u00e8me argument est un hit ou une liste de hits \u00e0 inclure dans l'offre group\u00e9e.\n    [\n        {\n            \"howler.analytic\": \"example-test\",\n            \"howler.score\": 0\n        },\n        {\n            \"howler.analytic\": \"example-test\",\n            \"howler.score\": 0\n        }\n    ]\n)\n\n\"\"\"Cr\u00e9ation d'un groupe howler \u00e0 partir de hits existants\"\"\"\nhowler.bundle.create(\n    {\n        \"howler.analytic\": \"example-test\",\n        \"howler.score\": 0,\n        \"howler.hits\": [\"YcUsL8QsjmwwIdstieROk\", \"6s7MztwuSvz6tM0PgGJhvz\"]\n    },\n    # Noter: Dans les prochaines versions, vous n'aurez plus besoin d'inclure cet argument.\n    []\n)\n\n\n\"\"\"Cr\u00e9ation \u00e0 partir d'une carte\"\"\"\nbundle_hit = {\n    \"score\": 0,\n    \"bundle\": True\n}\n\nmap = {\n    \"score\": [\"howler.score\"],\n    \"bundle\": [\"howler.is_bundle\"]\n}\n\nhowler.bundle.create_from_map(\"example-test\", bundle_hit, map, [{\"score\": 0}])\n</code></pre>"},{"location":"fr/ingestion/bundles/#visualiser-les-groupes-sur-linterface-utilisateur-de-howler","title":"Visualiser les groupes sur l'interface utilisateur de Howler","text":"<p>Afin de visualiser les groupes cr\u00e9\u00e9s sur l'interface utilisateur de Howler, vous pouvez utiliser la requ\u00eate `howler.example.com/hits?query=howler.is_bundle%3Atrue)).</p> <p>En cliquant sur un groupe, vous ouvrirez une interface de recherche l\u00e9g\u00e8rement diff\u00e9rente de l'interface normale. Dans ce cas, nous filtrons automatiquement les r\u00e9sultats de la recherche pour n'inclure que les r\u00e9sultats inclus dans le groupe. Pour que cela soit \u00e9vident, l'en-t\u00eate repr\u00e9sentant le groupe appara\u00eet au-dessus de la barre de recherche.</p> <p>Vous pouvez continuer \u00e0 filtrer les r\u00e9sultats en utilisant les m\u00eames requ\u00eates que d'habitude et \u00e0 les visualiser comme d'habitude. Lors du triage d'un groupe, son \u00e9valuation s'appliquera \u00e0 tous les hits du groupe, sauf ceux qui ont d\u00e9j\u00e0 \u00e9t\u00e9 tri\u00e9s. En d'autres termes, si le groupe est ouvert, tous les hits ouverts seront \u00e9valu\u00e9s lorsque vous l'\u00e9valuerez.</p> <p>Les groupes disposent \u00e9galement d'un onglet R\u00e9sum\u00e9 qui n'est pas disponible pour les hits ordinaires. Cet onglet vous aidera \u00e0 regrouper les donn\u00e9es relatives \u00e0 tous les r\u00e9sultats du groupe. Il suffit d'ouvrir l'onglet et de cliquer sur \"Cr\u00e9er un sommaire\". Notez que cette op\u00e9ration peut prendre un certain temps, car un grand nombre de requ\u00eates sont ex\u00e9cut\u00e9es pour agr\u00e9ger les donn\u00e9es.</p>"},{"location":"fr/ingestion/client/#documentation-du-client-howler","title":"Documentation du client Howler","text":"<p>Cette documentation explique comment interagir avec l'API howler en utilisant le client howler dans les environnements de d\u00e9veloppement Java et Python. Nous d\u00e9crirons le processus de base de la cr\u00e9ation d'un nouveau hit dans chaque environnement ainsi que la recherche dans howler des hits correspondant \u00e0 votre requ\u00eate.</p>"},{"location":"fr/ingestion/client/#mise-en-route","title":"Mise en route","text":""},{"location":"fr/ingestion/client/#installation","title":"Installation","text":"<p>Afin d'utiliser le client howler, vous devez le lister comme une d\u00e9pendance dans votre projet.</p>"},{"location":"fr/ingestion/client/#python","title":"Python","text":"<p>Il suffit de l'installer \u00e0 l'aide de pip:</p> <pre><code>pip install howler_client\n</code></pre> <p>Vous pouvez \u00e9galement l'ajouter \u00e0 votre requirements.txt, ou \u00e0 tout autre syst\u00e8me de gestion des d\u00e9pendances que vous utilisez. Une fois cette \u00e9tape termin\u00e9e, vous devriez pouvoir commencer \u00e0 utiliser le client howler !</p>"},{"location":"fr/ingestion/client/#authentification","title":"Authentification","text":"<p>Comme indiqu\u00e9 dans la Documentation sur l'authentification, les utilisateurs peuvent s'authentifier de diff\u00e9rentes mani\u00e8res. Pour interfacer avec le client howler, cependant, le flux sugg\u00e9r\u00e9 est d'utiliser une cl\u00e9 API. Avant de commencer, g\u00e9n\u00e9rons une cl\u00e9.</p> <ol> <li>Ouvrez l'interface utilisateur Howler avec laquelle vous souhaitez vous interfacer.</li> <li>Connectez-vous, puis cliquez sur votre profil en haut \u00e0 droite.</li> <li>Dans le menu utilisateur, cliquez sur Param\u00e8tres.</li> <li>Sous S\u00e9curit\u00e9 de l'utilisateur, appuyez sur l'ic\u00f4ne (+) sur la ligne Cl\u00e9s API.</li> <li>Nommez votre cl\u00e9 et donnez-lui les autorisations n\u00e9cessaires.</li> <li>Appuyez sur Create (Cr\u00e9er) et copiez la cha\u00eene fournie dans un endroit s\u00fbr. **Vous ne reverrez plus cette cha\u00eene.</li> </ol> <p>Cette cl\u00e9 API sera fournie \u00e0 votre code par la suite.</p>"},{"location":"fr/ingestion/client/#client-python","title":"Client Python","text":"<p>Pour se connecter \u00e0 howler en utilisant le client python, il y a un processus assez simple \u00e0 suivre:</p> <pre><code>from howler_client import get_client\n\nUSERNAME = 'user' # Obtenez-le \u00e0 partir de la page des param\u00e8tres de l'utilisateur de l'interface utilisateur de Howler.\nAPIKEY = 'apikey_name:apikey_data'\n\napikey = (USERNAME, APIKEY)\n\nhowler = get_client(\"$CURRENT_URL\", apikey=apikey)\n\nVoil\u00e0, c'est fait ! Vous pouvez maintenant utiliser l'objet `howler` pour interagir avec le serveur. A quoi cela ressemble-t-il en r\u00e9alit\u00e9?\n\n### Cr\u00e9er des hits en Python\n\nPour le client Python, vous pouvez cr\u00e9er des hits en utilisant la fonction `howler.hit.create_from_map`. Cette fonction prend trois arguments:\n\n- `tool name`: Le nom de l'outil d'analyse qui cr\u00e9e le hit\n- `map`: Une correspondance entre les donn\u00e9es brutes que vous avez et le sch\u00e9ma howler\n  - Le format est un dictionnaire o\u00f9 les cl\u00e9s sont le chemin aplati des donn\u00e9es brutes, et les valeurs sont une liste de chemins aplatis pour les champs de Howler dans lesquels les donn\u00e9es seront copi\u00e9es.\n- `documents`: Les donn\u00e9es brutes que vous voulez ajouter \u00e0 Howler.\n\nVoici un exemple simple:\n\n```python\n# La correspondance entre nos donn\u00e9es et le sch\u00e9ma de Howler\nhwl_map = {\n  \"file.sha256\": [\"file.hash.sha256\", \"howler.hash\"],\n  \"file.name\": [\"file.name\"],\n  \"src_ip\": [\"source.ip\", \"related.ip\"],\n  \"dest_ip\": [\"destination.ip\", \"related.ip\"],\n  \"time.created\": [\"event.start\"],\n}\n\n# Quelques fausses donn\u00e9es dans un format personnalis\u00e9 que nous voulons ajouter \u00e0 howler\nexample_hit = {\n  \"src_ip\": \"0.0.0.0\",\n  \"dest_ip\": \"8.8.8.8\",\n  \"file\": {\n    \"name\": \"hello.exe\",\n    \"sha256\": sha256(str(\"hello.exe\").encode()).hexdigest()\n  },\n  \"time\": {\n    \"created\": datetime.now().isoformat()\n  },\n}\n\n# Notez que le troisi\u00e8me argument est de type liste!\nhowler.hit.create_from_map(\"example_ingestor\", hwl_map, [example_hit])\n</code></pre>"},{"location":"fr/ingestion/client/#interroger-les-hits-en-python","title":"Interroger les hits en Python","text":"<p>L'interrogation des hits avec le client python howler se fait en utilisant la fonction <code>howler.search.hit</code>. Elle poss\u00e8de un certain nombre d'arguments obligatoires et optionnels:</p> <ul> <li>Obligatoire:</li> <li><code>query</code>: requ\u00eate lucene (cha\u00eene)</li> <li>Facultatif: <code>filters</code>: requ\u00eate lucene (cha\u00eene):</li> <li><code>filters</code>: Requ\u00eates lucene additionnelles utilis\u00e9es pour filtrer les donn\u00e9es (liste de cha\u00eenes)</li> <li><code>fl</code>: Liste des champs \u00e0 retourner (cha\u00eene de champs s\u00e9par\u00e9s par des virgules)</li> <li><code>offset</code>: Offset auquel les \u00e9l\u00e9ments de la requ\u00eate doivent commencer (entier)</li> <li><code>rows</code>: Nombre d'enregistrements \u00e0 retourner (entier)</li> <li><code>sort</code>: Champ utilis\u00e9 pour le tri avec direction (cha\u00eene: ex. 'id desc')</li> <li><code>timeout</code>: Nombre maximum de millisecondes d'ex\u00e9cution de la requ\u00eate (entier)</li> <li><code>use_archive</code>: Interroge \u00e9galement l'archive</li> <li><code>track_total_hits</code>: Nombre de hits \u00e0 suivre (par d\u00e9faut: 10k)</li> </ul> <p>Voici quelques exemples de requ\u00eates:</p> <pre><code># Rechercher tous les hits cr\u00e9\u00e9s par assemblyline, afficher les 50 premiers et ne renvoyer que leurs identifiants.\nhowler.search.hit(\"howler.analytic:assemblyline\", fl=\"howler.id\", rows=50)\n\n# Recherche de toutes les occurrences r\u00e9solues cr\u00e9\u00e9es au cours des cinq derniers jours, avec indication de leur identifiant et de l'analyste qui les a cr\u00e9\u00e9es. N'en afficher que dix, d\u00e9cal\u00e9s de 40\nhowler.search.hit(\"howler.status:resolved\", filters=['event.created:[now-5d TO now]'] fl=\"howler.id,howler.analytic\", rows=10, offset=40)\n\n# Recherche de tous les r\u00e9sultats, d\u00e9lai d'attente si la requ\u00eate prend plus de 100 ms\nhowler.search.hit(\"howler.id:*\", track_total_hits=100000000, timeout=100, use_archive=True)\n</code></pre>"},{"location":"fr/ingestion/key_generation/","title":"G\u00e9n\u00e9rer une cl\u00e9 API","text":"<p>Lors de l'int\u00e9gration de Howler dans un autre syst\u00e8me, vous ne devez pas enregistrer votre nom d'utilisateur et votre mot de passe dans une autre application. Au lieu de cela, vous devez cr\u00e9er une cl\u00e9 API avec seulement les exigences appropri\u00e9es pour cette int\u00e9gration sp\u00e9cifique.</p>"},{"location":"fr/ingestion/key_generation/#creer-une-cle-api","title":"Cr\u00e9er une cl\u00e9 API","text":"<ol> <li>Connectez-vous \u00e0 l'interface utilisateur de Howler avec l'utilisateur qui effectuera les requ\u00eates API.</li> <li>Cliquez sur votre avatar dans le coin sup\u00e9rieur droit de l'interface utilisateur de Howler et s\u00e9lectionnez \"Settings\" (Param\u00e8tres)</li> <li>Faites d\u00e9filer vers le bas jusqu'\u00e0 la section \"S\u00e9curit\u00e9 de l'utilisateur\" et appuyez sur le bouton plus.</li> <li>Ajoutez le nom de la cl\u00e9 API, s\u00e9lectionnez les privil\u00e8ges d'acc\u00e8s et les dates d'expiration, puis cliquez sur le bouton \"Cr\u00e9er\".</li> <li>La cl\u00e9 API ne sera affich\u00e9e qu'une seule fois et ne pourra pas \u00eatre r\u00e9cup\u00e9r\u00e9e. Copiez-la dans un endroit s\u00fbr afin de pouvoir l'utiliser ult\u00e9rieurement.</li> <li>Fermez le tiroir.</li> </ol>"},{"location":"fr/ingestion/links/#liens-du-hit","title":"Liens du hit","text":"<p>Afin de faciliter l'ajout d'outils suppl\u00e9mentaires que l'on peut utiliser pour suivre un hit, Howler permet aux utilisateurs de sp\u00e9cifier un ensemble de liens, ainsi qu'un titre et une ic\u00f4ne \u00e0 afficher. Cette documentation vous expliquera comment utiliser ces liens.</p>"},{"location":"fr/ingestion/links/#specification","title":"Specification","text":"<p>Afin d'ajouter des liens, vous pouvez utiliser le champ <code>howler.links</code>. Ce champ contient une liste d'objets avec trois cl\u00e9s :</p> <pre><code>hit = {\n  \"howler.links\": [\n    {\n      \"title\": \"Titre du lien avec image interne\",\n      \"href\": \"https://example.com\",\n      # Notez qu'il s'agit d'une autre application, et non d'un lien vers une image.\n      \"icon\": \"superset\",\n    },\n    {\n      \"title\": \"Titre du lien avec image externe\",\n      \"href\": \"https://www.britannica.com/animal/goose-bird\",\n      # Notez qu'il s'agit d'un lien vers une image. Nous ne fournissons pas d'h\u00e9bergement, vous devrez donc l'h\u00e9berger ailleurs !\n      \"icon\": \"https://cdn.britannica.com/76/76076-050-39DDCBA1/goose-Canada-North-America.jpg\",\n    },\n  ]\n}\n</code></pre> <p>Notez que l'ic\u00f4ne peut \u00eatre soit : 1. Un nom identifiant une application interne, pour utiliser son ic\u00f4ne 2. Une URL externe</p> <p>Si vous souhaitez utiliser une application interne, les valeurs suivantes sont actuellement prises en charge :</p> <p>$APP_LIST</p> <p>L'utilisation de l'une de ces valeurs entra\u00eene automatiquement l'utilisation de l'ic\u00f4ne correspondante. Inutile d'h\u00e9berger la v\u00f4tre !</p>"},{"location":"fr/ingestion/user/","title":"Cr\u00e9er des utilisateurs dans Howler","text":"<p>Howler ne dispose pas actuellement d'une interface graphique pour la cr\u00e9ation d'utilisateurs. La mani\u00e8re g\u00e9n\u00e9ralement sugg\u00e9r\u00e9e de cr\u00e9er des utilisateurs est de connecter Howler \u00e0 un fournisseur OAuth 2.0 (azure, google, etc.) et de cr\u00e9er un utilisateur bas\u00e9 sur le jeton d'authentification JWT renvoy\u00e9. Ceci est d\u00e9j\u00e0 g\u00e9r\u00e9 dans Howler, et n\u00e9cessite juste la mise en place d'un fournisseur OAuth externe (voir ici pour les informations de configuration).</p> <p>Si vous souhaitez cr\u00e9er un utilisateur directement, sans passer par la cr\u00e9ation d'OAuth, vous pouvez utiliser le script suivant, sur la m\u00eame machine que celle sur laquelle Howler est h\u00e9berg\u00e9 :</p> <pre><code>from howler.common.logging import get_logger\nfrom howler.odm.models.user import User\nfrom howler.security.utils import get_password_hash\nfrom howler.common.loader import datastore\n\nlogger = get_logger(__file__)\n\n\ndef create_user(name: str, email: str, username: str):\n    \"\"\"Cr\u00e9er un utilisateur de base avec un nom d'utilisateur, un email et un mot de passe\"\"\"\n\n    ds = datastore()\n\n    user_data = User(\n        {\n            \"name\": name,\n            \"email\": email,\n            \"password\": get_password_hash(username),\n            \"uname\": f\"{username}\",\n        }\n    )\n    ds.user.save(username, user_data)\n    logger.info(f\"{username}:{username}\")\n\n    ds.user.commit()\n\n\nif __name__ == \"__main__\":\n    name = input(\"Entrer le nom:\\n&gt; \")\n    username = input(\"\\nEntrer le nom d'utilisateur:\\n&gt; \")\n    email = input(\"\\nEntrer l'email:\\n&gt; \")\n\n    print(\n        f\"Un nouvel utilisateur sera cr\u00e9\u00e9.\\n\\tNom: {name}\\n\\tNom d'utilisateur: {username}\\n\\tEmail: {email}\"\n    )\n\n    create_user(name, email, username)\n</code></pre> <p>Un ticket pour la cr\u00e9ation d'un utilisateur graphique a \u00e9t\u00e9 cr\u00e9\u00e9 et est actuellement en cours de d\u00e9veloppement.</p>"},{"location":"fr/overview/detection_engineers/","title":"Ing\u00e9nieurs en d\u00e9tection","text":"<p>Vous venez d'\u00e9crire une analyse qui d\u00e9tecte une activit\u00e9 suspecte et vous aimeriez que votre centre d'op\u00e9rations de s\u00e9curit\u00e9 (SOC) en b\u00e9n\u00e9ficie. Dans Howler, un \u00e9v\u00e9nement int\u00e9ressant est appel\u00e9 un hit. Le terme alerte est r\u00e9serv\u00e9 aux occurrences qui n\u00e9cessitent un triage.</p> <p>Pour cr\u00e9er un nouveau hit, produisez un objet JSON dans lequel vous avez normalis\u00e9 les donn\u00e9es de l'\u00e9v\u00e9nement selon Elastic Common Schema. Nous proc\u00e9dons ainsi pour que les analystes de triage disposent d'un sch\u00e9ma unique \u00e0 apprendre quelle que soit la source des alertes, ce qui leur facilitera grandement la t\u00e2che.</p> <p>Ensuite, vous devez remplir certains champs sp\u00e9cifiques \u00e0 Howler :</p> <ul> <li><code>howler.detection</code> - Un identifiant court et unique pour la d\u00e9tection sp\u00e9cifique.</li> <li><code>howler.analytic</code> - Le produit qui effectue la d\u00e9tection. Certains produits analytiques ex\u00e9cuteront plusieurs d\u00e9tections distinctes.</li> <li><code>howler.outline.threat</code> - L'identifiant qui repr\u00e9sente le mieux l'attaquant. Il peut s'agir d'une adresse IP, d'une adresse \u00e9lectronique, etc...</li> <li><code>howler.outline.target</code> - L'identifiant qui repr\u00e9sente le mieux la victime. L\u00e0 encore, il peut s'agir d'une adresse IP, d'un domaine, d'une adresse \u00e9lectronique, etc...</li> <li><code>howler.outline.indicators</code> - Une liste libre d'indicateurs de compromission (IoC). Il s'agit g\u00e9n\u00e9ralement d'adresses IP, de domaines et de hachages.</li> <li><code>howler.outline.summary</code> - Un r\u00e9sum\u00e9 expliquant l'activit\u00e9 d\u00e9tect\u00e9e. Il d\u00e9crit l'\u00e9v\u00e9nement en supposant que la d\u00e9tection est correcte.</li> <li><code>howler.data</code> - Une liste de dictionnaires de l'\u00e9v\u00e9nement brut avant normalisation. Cela facilite la t\u00e2che des analystes s'ils doivent mener leur enqu\u00eate en dehors de Howler.</li> </ul> <p>Howler utilise des niveaux d'escalade (<code>howler.escalation</code>) pour cat\u00e9goriser les hits :</p> <ul> <li><code>miss</code> - L'\u00e9v\u00e9nement est \u00e9valu\u00e9 comme n'\u00e9tant pas li\u00e9 \u00e0 la d\u00e9tection (faux-positif).</li> <li><code>hit</code> - (par d\u00e9faut) L'\u00e9v\u00e9nement peut ne pas \u00eatre tr\u00e8s fiable sans contexte suppl\u00e9mentaire.</li> <li><code>alert</code> - L'\u00e9v\u00e9nement doit \u00eatre \u00e9valu\u00e9 par un analyste de triage.</li> <li><code>evidence</code> - L'\u00e9v\u00e9nement a \u00e9t\u00e9 \u00e9valu\u00e9 comme \u00e9tant li\u00e9 \u00e0 la d\u00e9tection (vrai-positif).</li> </ul> <p>Vous pouvez promouvoir certains hits en alertes imm\u00e9diates au moment de la cr\u00e9ation si l'on s'attend \u00e0 ce que tous les hits m\u00e9ritent d'\u00eatre tri\u00e9s.</p> <p>Une fois l'objet JSON compl\u00e9t\u00e9, utilisez le client Howler pour cr\u00e9er un nouveau r\u00e9sultat positif. Ce r\u00e9sultat sera imm\u00e9diatement disponible pour les analystes de triage \u00e0 partir de l'interface utilisateur de Howler.</p>"},{"location":"fr/overview/detection_engineers/#les-groupes-des-hits","title":"Les groupes des hits","text":"<p>Un ensemble est un regroupement logique de r\u00e9sultats qui doivent \u00eatre \u00e9valu\u00e9s ensemble. Par exemple, si une s\u00e9rie d'occurrences multiples se produit sur le m\u00eame h\u00f4te dans un court laps de temps, un analyste de triage devrait effectuer une enqu\u00eate unique qui les prend toutes en compte. L'interface utilisateur de Howler fournit un flux de travail permettant de travailler intuitivement avec ces ensembles.</p> <p>Les bundles sont impl\u00e9ment\u00e9s comme des hits dont le champ howler.is_bundle est d\u00e9fini sur true, et howler.hits contient une liste de valeurs howler.id. Cela signifie que des analyses peuvent \u00eatre cr\u00e9\u00e9es pour rechercher des occurrences li\u00e9es et les regrouper.</p>"},{"location":"fr/overview/detection_engineers/#page-danalyse","title":"Page d'analyse","text":"<p>La section Analytics de l'interface utilisateur de Howler fournit une page de support pour les analyses et les d\u00e9tections individuelles. Elle contient des informations utiles \u00e0 la fois pour l'auteur d'une analyse ou d'une d\u00e9tection et pour les analystes de triage qui enqu\u00eatent sur les hits.</p>"},{"location":"fr/overview/detection_engineers/#vue-densemble","title":"Vue d'ensemble","text":"<p>Ici, vous \u00eates encourag\u00e9 \u00e0 fournir de la documentation en Markdown. Celle-ci devrait fournir plus de d\u00e9tails sur le fonctionnement de l'analyse ou de la d\u00e9tection, sur ce qu'elle recherche et sur la mani\u00e8re de valider les r\u00e9sultats.</p> <p>Des mesures sont automatiquement g\u00e9n\u00e9r\u00e9es pour donner un aper\u00e7u des performances. Un taux de faux positifs tr\u00e8s \u00e9lev\u00e9 peut \u00eatre le signe que la d\u00e9tection doit \u00eatre am\u00e9lior\u00e9e. En revanche, un taux \u00e9lev\u00e9 de vrais positifs peut justifier que les occurrences soient automatiquement promues au rang d'alertes.</p>"},{"location":"fr/overview/detection_engineers/#commentaires","title":"Commentaires","text":"<p>Dans cet onglet, les utilisateurs peuvent laisser des commentaires sur une analyse ou une d\u00e9tection. Il s'agit de la ligne de communication de l'utilisateur final avec vous.</p>"},{"location":"fr/overview/detection_engineers/#commentaires-sur-les-resultats","title":"Commentaires sur les r\u00e9sultats","text":"<p>\u00c0 partir de cet onglet, vous pouvez consulter tous les commentaires laiss\u00e9s sur des r\u00e9sultats sp\u00e9cifiques afin de mieux comprendre ce que les analystes de triage se signalent les uns aux autres.</p>"},{"location":"fr/overview/detection_engineers/#carnets-de-notes","title":"Carnets de notes","text":"<p>Si vos analystes de triage ont fr\u00e9quemment besoin d'enqu\u00eater sur des alertes en dehors de Howler, vous pouvez cr\u00e9er un lien vers un carnet de notes Jupyter. Cela signifie qu'un bouton appara\u00eetra dans l'interface utilisateur de Howler. Lorsqu'un utilisateur clique sur le bouton, il est dirig\u00e9 vers JupyterHub avec le Notebook sp\u00e9cifi\u00e9 ouvert et le hit sp\u00e9cifique charg\u00e9, ce qui permet aux requ\u00eates d'\u00eatre pr\u00e9-remplies avec des valeurs pertinentes.</p>"},{"location":"fr/overview/triage_analysts/","title":"Analystes de triage","text":"<p>Howler est con\u00e7u pour consolider les alertes provenant de toutes les sources et diff\u00e9rencier celles qui n\u00e9cessitent un triage de celles qui n'en n\u00e9cessitent pas. Les ing\u00e9nieurs de d\u00e9tection sont cens\u00e9s normaliser les alertes, de sorte qu'elles puissent toutes \u00eatre consult\u00e9es et compar\u00e9es avec un sch\u00e9ma commun : Elastic Common Schema (ECS). En regroupant toutes les alertes sous un m\u00eame sch\u00e9ma, il est beaucoup plus facile de trouver des \u00e9v\u00e9nements corr\u00e9l\u00e9s qui justifient un examen minutieux de la part d'un analyste de triage. Par exemple, un analyste peut facilement trouver toutes les alertes li\u00e9es \u00e0 une IP source donn\u00e9e avec un seul crit\u00e8re de filtrage, quel que soit le sch\u00e9ma de la t\u00e9l\u00e9m\u00e9trie d'origine.</p> <p>Howler exige que les ing\u00e9nieurs de d\u00e9tection d\u00e9crivent explicitement le qui, le quoi, le quand, le o\u00f9 et le pourquoi de chaque alerte qu'ils produisent. Cela signifie que les analystes de triage ne sont pas confront\u00e9s \u00e0 des alertes cryptiques qui ne donnent aucun indice sur la mani\u00e8re de les valider. Par exemple, les champs menace et cible indiquent clairement qui attaque qui.</p> <p>L'autre grande am\u00e9lioration offerte par Howler est la personnalisation. Chaque type d'\u00e9v\u00e9nement peut avoir une pr\u00e9sentation personnalis\u00e9e, de sorte que nous n'inondons pas l'\u00e9cran de l'analyste de triage avec des informations sans importance ou que nous ne laissons pas des d\u00e9tails importants cach\u00e9s derri\u00e8re de multiples clics. Par exemple, pour certaines alertes, le champ HTTP referrer peut \u00eatre critique, mais pour d'autres, il peut \u00eatre sans importance.</p> <p>Howler prend en charge l'automatisation en faisant correspondre les alertes aux filtres. Si une nouvelle alerte correspond au filtre pr\u00e9par\u00e9, les actions sp\u00e9cifi\u00e9es seront automatiquement ex\u00e9cut\u00e9es. Celles-ci incluent la priorisation, le marquage et les \u00e9valuations, pour n'en citer que quelques-unes. Si un analyste voit constamment des alertes pour le m\u00eame script sys-admin alors qu'il sait qu'il s'agit d'une activit\u00e9 l\u00e9gitime, il peut ajouter une action pour appliquer une \u00e9tiquette \"sys-admin\" aux alertes qui correspondent \u00e0 un filtre soigneusement adapt\u00e9. Ensuite, ils pourraient d\u00e9cider d'\u00e9valuer automatiquement toute alerte avec une \u00e9tiquette \"sys-admin\" comme \"l\u00e9gitime\" afin d'\u00e9viter de gaspiller des efforts pour les trier.</p> <p>Toutes ces fonctionnalit\u00e9s se combinent pour fournir aux \u00e9quipes de triage une suite compl\u00e8te d'outils qui leur permet de traiter plus d'alertes de mani\u00e8re plus d\u00e9taill\u00e9e.</p>"},{"location":"fr/overview/triage_analysts/#hits","title":"Hits","text":"<p>Un grand nombre d'\u00e9v\u00e9nements d\u00e9tect\u00e9s ne sont que des indicateurs faibles et ne valent pas la peine d'\u00eatre tri\u00e9s individuellement, c'est pourquoi nous les appelons hits. Howler utilise le terme alerte pour d\u00e9crire le sous-ensemble qui doit \u00eatre tri\u00e9. Tous ceux qui sont consid\u00e9r\u00e9s comme inexacts (faux positifs) peuvent \u00eatre r\u00e9trograd\u00e9s \u00e0 miss, tandis que ceux qui sont consid\u00e9r\u00e9s comme exacts sont promus \u00e0 evidence.</p> <p>Le continuum d'escalade est le suivant : miss -&gt; hit -&gt; alert -&gt; evidence</p> <p>Dans la plupart des cas, les analystes de triage s'int\u00e9ressent aux alertes, qu'ils font passer \u00e0 l'\u00e9tat de preuves ou qu'ils r\u00e9trogradent \u00e0 l'\u00e9tat d'\u00e9chec. Pour examiner les alertes, l'analyste de triage se rend sur la page Alerts dans la barre lat\u00e9rale gauche. Une bo\u00eete de filtre lui est alors pr\u00e9sent\u00e9e. La syntaxe du filtre est Lucene. Le sch\u00e9ma des donn\u00e9es est Elastic Common Schema (ECS).</p> <p>Pour filtrer une certaine escalade, filtrez sur <code>howler.escalation</code>. Par exemple, pour regarder les alertes, \u00e9crivez : <code>howler.escalation : alert</code>.</p>"},{"location":"fr/overview/triage_analysts/#hit-cards","title":"Hit Cards","text":"<p>L'interface utilisateur de Howler affiche une version abr\u00e9g\u00e9e de chaque hit sous forme de carte. Ceci est con\u00e7u de mani\u00e8re \u00e0 r\u00e9duire la quantit\u00e9 d'efforts n\u00e9cessaires \u00e0 un analyste de triage pour comprendre la nature du hit et son contexte.</p>"},{"location":"fr/overview/triage_analysts/#banniere","title":"Banni\u00e8re","text":"<p>La banni\u00e8re situ\u00e9e en haut de chaque r\u00e9sultat fournit un contexte normalis\u00e9 abordant les questions suivantes : qui, quoi, quand, o\u00f9 et pourquoi.</p>"},{"location":"fr/overview/triage_analysts/#titre","title":"Titre","text":"<p>Le titre de la carte correspond \u00e0 l'analyse et \u00e0 la d\u00e9tection \u00e0 l'origine du r\u00e9sultat positif. Le produit logiciel qui a cr\u00e9\u00e9 la r\u00e9ponse positive est appel\u00e9 analytique. La logique de recherche et de s\u00e9lection d'\u00e9v\u00e9nements sp\u00e9cifiques est appel\u00e9e d\u00e9tection. Une analyse peut avoir plusieurs d\u00e9tections. Ces deux concepts sont exprim\u00e9s dans les champs <code>howler.analytic</code> et <code>howler.detection</code>.</p> <p>Vous pouvez filtrer les hits appartenant \u00e0 une d\u00e9tection sp\u00e9cifique. Par exemple, pour regarder les hits produits par une d\u00e9tection appel\u00e9e \"User Creds Beacon\", \u00e9crivez : <code>howler.detection : \"User Creds Beacon\"</code>.</p>"},{"location":"fr/overview/triage_analysts/#icone","title":"Ic\u00f4ne","text":"<p>Le nom repr\u00e9sente l'organisation, le d\u00e9partement ou l'\u00e9quipe concern\u00e9s. Il est stock\u00e9 dans <code>organization.name</code>. La gauche de la banni\u00e8re est color\u00e9e en fonction du m\u00e9canisme de collecte des \u00e9v\u00e9nements. Ceci est d\u00e9termin\u00e9 par le champ <code>event.provider</code>. L'image repr\u00e9sente le cadre Mitre ATT&amp;CK sp\u00e9cifi\u00e9 dans <code>threat.tactic.id</code> ou <code>threat.technique.id</code>.</p>"},{"location":"fr/overview/triage_analysts/#statut","title":"Statut","text":"<p>\u00c0 droite de la banni\u00e8re se trouve le statut. Il comporte un horodatage, l'utilisateur auquel le hit est attribu\u00e9 et l'escalade pour le hit. En outre, si d'autres utilisateurs sont en train d'examiner cette r\u00e9ponse positive, leur ic\u00f4ne appara\u00eetra dans cette section.</p>"},{"location":"fr/overview/triage_analysts/#contexte","title":"Contexte","text":"<p>La partie inf\u00e9rieure de la banni\u00e8re pr\u00e9sente les principaux aspects du contexte n\u00e9cessaires \u00e0 la compr\u00e9hension de la r\u00e9ponse positive.</p>"},{"location":"fr/overview/triage_analysts/#menace","title":"Menace","text":"<p>L'identifiant qui repr\u00e9sente le mieux l'attaquant. Il peut s'agir d'une adresse IP, d'une adresse \u00e9lectronique, etc. Utilisez-le pour trouver d'autres r\u00e9sultats qui semblent provenir du m\u00eame attaquant. (<code>howler.outline.threat</code>)</p>"},{"location":"fr/overview/triage_analysts/#cible","title":"Cible","text":"<p>L'identifiant qui repr\u00e9sente le mieux l'attaquant. Il peut s'agir d'une adresse IP, d'une adresse \u00e9lectronique, etc. Utilisez-le pour trouver d'autres hits qui semblent affecter la m\u00eame victime. (<code>howler.outline.target</code>)</p>"},{"location":"fr/overview/triage_analysts/#indicateurs","title":"Indicateurs","text":"<p>Une liste libre d'indicateurs de compromission (IoC). Il s'agit g\u00e9n\u00e9ralement d'adresses IP, de domaines et de hachages. Utilisez-la pour trouver des attaques similaires bas\u00e9es sur leur infrastructure et leurs tactiques. (<code>howler.outline.indicators</code>)</p>"},{"location":"fr/overview/triage_analysts/#resume","title":"R\u00e9sum\u00e9","text":"<p>Un r\u00e9sum\u00e9 expliquant l'activit\u00e9 d\u00e9tect\u00e9e. Lors de l'\u00e9valuation d'un hit, vous essayez de corroborer ou de r\u00e9futer cette d\u00e9claration. (<code>howler.outline.summary</code>)</p>"},{"location":"fr/overview/triage_analysts/#details","title":"D\u00e9tails","text":"<p>Cette section peut afficher des m\u00e9tadonn\u00e9es suppl\u00e9mentaires contenues dans une alerte. Les champs affich\u00e9s doivent \u00eatre ceux qui sont les plus importants pour l'\u00e9valuation de cette d\u00e9tection particuli\u00e8re.</p>"},{"location":"fr/overview/triage_analysts/#modeles","title":"Mod\u00e8les","text":"<p>Les mod\u00e8les sont le m\u00e9canisme utilis\u00e9 pour personnaliser les champs affich\u00e9s dans la section des d\u00e9tails d'une carte d'occurrences. En haut \u00e0 droite de la section des d\u00e9tails d'une fiche de r\u00e9sultat, une ic\u00f4ne indique si vous \u00eates en train de consulter un mod\u00e8le global ou personnel. En cliquant sur cette ic\u00f4ne, vous pourrez modifier le mod\u00e8le.</p> <p>Vous pouvez indiquer ici si vous cr\u00e9ez un mod\u00e8le pour toutes les occurrences d'une analyse donn\u00e9e ou, en option, pour les occurrences d'une d\u00e9tection sp\u00e9cifique.</p> <p>Vous pouvez en faire un filtre personnel qui n'affecte que les fiches de r\u00e9sultats que vous voyez. Ce filtre pr\u00e9vaudra sur tout filtre global. Si votre filtre est global, il affectera le mod\u00e8le de tout utilisateur qui n'a pas cr\u00e9\u00e9 de mod\u00e8le personnel.</p> <p>Lors de la conception d'un mod\u00e8le, vous pouvez ajouter ou supprimer n'importe quel champ figurant dans les m\u00e9tadonn\u00e9es de la r\u00e9ponse. Tous les champs pr\u00e9sents seront affich\u00e9s dans les d\u00e9tails des occurrences correspondant \u00e0 l'analyse ou \u00e0 la d\u00e9tection. \u00c9vitez d'ajouter des champs qui ne sont pas n\u00e9cessaires \u00e0 une \u00e9valuation, car ils ralentiront la vitesse \u00e0 laquelle les analystes peuvent interpr\u00e9ter la fiche de r\u00e9sultat.</p>"},{"location":"fr/overview/triage_analysts/#dossier","title":"Dossier","text":"<p>En cliquant sur une carte de correspondance, vous ouvrirez son dossier sur le c\u00f4t\u00e9 droit de l'interface utilisateur de Howler. Une s\u00e9rie d'onglets fournit des informations suppl\u00e9mentaires sur une correspondance donn\u00e9e. En haut se trouve la m\u00eame banni\u00e8re que celle qui figure en haut d'une fiche d'occurrences. Si l'ing\u00e9nieur de d\u00e9tection a pr\u00e9vu une int\u00e9gration avec des outils externes, son bouton (image) appara\u00eetra sous la banni\u00e8re.</p>"},{"location":"fr/overview/triage_analysts/#commentaires","title":"Commentaires","text":"<p>Cette section vous permet d'\u00e9crire des commentaires pour vous-m\u00eame ou vos coll\u00e8gues.</p>"},{"location":"fr/overview/triage_analysts/#json","title":"JSON","text":"<p>Cette section affiche une repr\u00e9sentation JSON des m\u00e9tadonn\u00e9es de la r\u00e9ponse positive, y compris tous les champs que l'ing\u00e9nieur de d\u00e9tection a mis en correspondance avec ECS.</p>"},{"location":"fr/overview/triage_analysts/#donnees-brutes","title":"Donn\u00e9es brutes","text":"<p>Il s'agit de l'\u00e9v\u00e9nement brut identifi\u00e9 par la d\u00e9tection. Il s'agira d'une liste d'\u00e9v\u00e9nements si plusieurs sont concern\u00e9s. Utilisez-la si vous avez besoin de poursuivre votre enqu\u00eate en dehors de Howler. Il montrera les noms de champs originaux avant le mappage \u00e0 ECS, afin que vous puissiez construire les bonnes requ\u00eates.</p>"},{"location":"fr/overview/triage_analysts/#journal-de-travail","title":"Journal de travail","text":"<p>Toutes les modifications apport\u00e9es \u00e0 un r\u00e9sultat donn\u00e9 sont enregistr\u00e9es ici.</p>"},{"location":"fr/overview/triage_analysts/#liens-connexes","title":"Liens connexes","text":"<p>Ces liens sont fournis s'ils offrent un contexte suppl\u00e9mentaire utile qui n'a pas pu \u00eatre int\u00e9gr\u00e9 \u00e0 Howler.</p>"},{"location":"fr/overview/triage_analysts/#controles","title":"Contr\u00f4les","text":"<p>Au bas du dossier se trouve une s\u00e9rie de contr\u00f4les qui permettent aux analystes d'affecter les r\u00e9sultats de diff\u00e9rentes mani\u00e8res.</p>"},{"location":"fr/overview/triage_analysts/#gerer","title":"G\u00e9rer","text":"<ul> <li>Promouvoir : Passer d'une r\u00e9ponse positive \u00e0 une alerte</li> <li>D\u00e9missionner : Passer de l'alerte \u00e0 la r\u00e9ponse positive</li> <li>Attribuer \u00e0 moi : Signaler aux autres que vous \u00e9valuerez cette r\u00e9ponse positive.</li> <li>D\u00e9l\u00e9guer : signaler \u00e0 une personne ou \u00e0 une \u00e9quipe qu'elle doit \u00e9valuer ce r\u00e9sultat : Signaler \u00e0 une personne ou \u00e0 une \u00e9quipe qu'elle doit \u00e9valuer ce r\u00e9sultat.</li> <li>Rel\u00e2cher : Ram\u00e8ne le r\u00e9sultat \u00e0 l'\u00e9tat non attribu\u00e9.</li> <li>Pause : Signale que vous retardez votre \u00e9valuation.</li> <li>Reprise : Signale que vous travaillez \u00e0 nouveau sur votre \u00e9valuation.</li> </ul> <p>Les options propos\u00e9es ici changent en fonction de l'\u00e9tat actuel de la r\u00e9ponse positive, de sorte que vous ne verrez que quelques choix \u00e0 un moment donn\u00e9.</p>"},{"location":"fr/overview/triage_analysts/#evaluer","title":"\u00c9valuer","text":"<p>C'est ici que vous pouvez indiquer le verdict final de votre enqu\u00eate. (<code>howler.assessment</code>)</p> <ul> <li>Ambiguous: Il n'y avait pas assez d'informations pour faire une \u00e9valuation.</li> <li>Security: L'\u00e9v\u00e9nement est une activit\u00e9 de cybers\u00e9curit\u00e9 autoris\u00e9e, comme des exercices d'entra\u00eenement.</li> <li>Development: La r\u00e9ponse positive a \u00e9t\u00e9 obtenue \u00e0 des fins de d\u00e9veloppement et doit \u00eatre ignor\u00e9e.</li> <li>False-Positive: L'\u00e9v\u00e9nement ne correspond pas aux circonstances recherch\u00e9es par la d\u00e9tection.</li> <li>Legitimate: L'\u00e9v\u00e9nement correspond \u00e0 une activit\u00e9 autoris\u00e9e.</li> <li>Trivial: L'\u00e9v\u00e9nement n'a pas d'impact significatif : L'impact de l'\u00e9v\u00e9nement n'est pas suffisamment important pour m\u00e9riter d'\u00eatre att\u00e9nu\u00e9.</li> <li>Recon: L'\u00e9v\u00e9nement repr\u00e9sente une reconnaissance, mais ne constitue pas une menace imminente.</li> <li>Attempt: L'\u00e9v\u00e9nement repr\u00e9sente une tentative d'attaque qui ne constitue pas une menace imminente : L'\u00e9v\u00e9nement repr\u00e9sente une tentative d'attaque qui ne semble pas avoir abouti.</li> <li>Compromise: L'\u00e9v\u00e9nement repr\u00e9sente une compromission r\u00e9ussie qui doit \u00eatre att\u00e9nu\u00e9e.</li> <li>Mitigated: L'\u00e9v\u00e9nement repr\u00e9sente une compromission r\u00e9ussie qui doit \u00eatre att\u00e9nu\u00e9e : L'\u00e9v\u00e9nement repr\u00e9sente une compromission r\u00e9ussie pour laquelle des mesures d'att\u00e9nuation sont en cours.</li> </ul> <p>Justification : Une fois que vous avez ajout\u00e9 une \u00e9valuation, il vous est demand\u00e9 de fournir une justification sous forme de texte libre. Il s'agit d'un r\u00e9sum\u00e9 rapide expliquant \u00e0 vos coll\u00e8gues, ou \u00e0 votre futur vous-m\u00eame, pourquoi vous avez confiance en cette \u00e9valuation. (<code>howler.rationale</code>)</p>"},{"location":"fr/overview/triage_analysts/#vote","title":"Vote","text":"<p>Lorsqu'un analyste ne dispose pas de suffisamment d'informations pour proc\u00e9der \u00e0 une \u00e9valuation fiable, mais qu'il a une \"intuition\" concernant l'\u00e9v\u00e9nement, il peut placer un vote. C'est \u00e0 l'\u00e9quipe de triage de d\u00e9cider comment elle utilise les votes, mais on pourrait sugg\u00e9rer qu'un consensus dans les votes soit utilis\u00e9 pour faire une \u00e9valuation. (<code>howler.votes.bening/obscure/malicieux</code>)</p>"},{"location":"fr/overview/triage_analysts/#vues","title":"Vues","text":"<p>La r\u00e9daction de filtres peut prendre beaucoup de temps. Les analystes de triage ont souvent besoin d'utiliser les m\u00eames filtres pour leur flux de travail. Howler rationalise cela gr\u00e2ce aux vues. Apr\u00e8s avoir \u00e9crit un filtre, cliquez sur l'ic\u00f4ne en forme de c\u0153ur \u00e0 droite du filtre et sp\u00e9cifiez un nom. Cette vue est maintenant accessible \u00e0 partir du Gestionnaire de vues sur la barre lat\u00e9rale gauche. Si vous cliquez sur l'\u00e9toile \u00e0 droite d'un filtre ici, il appara\u00eetra sous Vues sauvegard\u00e9es dans la barre lat\u00e9rale de gauche.</p>"},{"location":"fr/overview/triage_analysts/#vues-globales","title":"Vues globales","text":"<p>Les membres d'une \u00e9quipe utilisent souvent les m\u00eames filtres. En sp\u00e9cifiant une vue comme globale lors de sa cr\u00e9ation, les autres utilisateurs verront cette vue dans la page Vues globales sous le filtre GLOBAL.</p>"},{"location":"fr/overview/triage_analysts/#groupes-des-hits","title":"Groupes des Hits","text":"<p>Lorsque plusieurs \u00e9v\u00e9nements semblent li\u00e9s les uns aux autres, ils peuvent \u00eatre regroup\u00e9s sous la forme d'un ensemble.Il s'agit d'un type sp\u00e9cial de r\u00e9sultat qui renvoie \u00e0 d'autres r\u00e9sultats.Ils peuvent \u00eatre identifi\u00e9s par le filtre <code>howler.is_bundle:true</code>. Les hits associ\u00e9s peuvent \u00eatre trouv\u00e9s dans la liste <code>howler.hits</code> qui contient la valeur <code>howler.id</code> de chacun.Lorsqu'un analyste de triage clique sur la carte d'une liasse, la banni\u00e8re de la liasse est d\u00e9plac\u00e9e au-dessus de la barre de filtre et les cartes des occurrences de la liasse sont affich\u00e9es sous la barre de filtre.Tout filtre fourni ne s'appliquera qu'aux occurrences associ\u00e9es \u00e0 la liasse.</p> <p>Tout contr\u00f4le utilis\u00e9 sur l'offre group\u00e9e sera automatiquement propag\u00e9 aux r\u00e9sultats qui lui sont associ\u00e9s.</p> <p>Un bon exemple de r\u00e9sultats que vous souhaiteriez regrouper serait une s\u00e9quence de r\u00e9sultats se produisant sur le m\u00eame h\u00f4te dans un court laps de temps.Individuellement, ces r\u00e9sultats pourraient \u00eatre beaucoup trop peu fiables pour envisager de les trier, mais avec le contexte suppl\u00e9mentaire que plusieurs d'entre eux se produisent sur le m\u00eame h\u00f4te dans une courte fen\u00eatre de temps, il serait raisonnable de promouvoir automatiquement le regroupement en alerte pour s'assurer que quelqu'un le triera.En les regroupant, nous nous assurons que non seulement un analyste de triage examine l'h\u00f4te, mais qu'il est \u00e9galement au courant de toutes les autres activit\u00e9s potentiellement li\u00e9es qui ont lieu.### R\u00e9sum\u00e9 de l'offre group\u00e9eLes offres group\u00e9es disposent d'un onglet suppl\u00e9mentaire dans le dossier de l'offre group\u00e9e, appel\u00e9 R\u00e9sum\u00e9.Si vous cliquez sur le bouton Cr\u00e9er un r\u00e9sum\u00e9, il comptera les valeurs distinctes de chaque fichier des occurrences. Utilisez cette fonction pour vous faire une id\u00e9e de la situation globale.</p>"}]}